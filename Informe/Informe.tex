\documentclass[10pt]{article}
% Language setting
% Replace `english' with e.g. `spanish' to change the document language
\usepackage[spanish]{babel}

% Set page size and margins
% Replace `letterpaper' with`a4paper' for UK/EU standard size
\usepackage[a4paper,top=1.9cm,bottom=3.67cm,left=1.9cm,right=1.32cm,marginparwidth=1.75cm]{geometry}

% Useful packages
\usepackage{amsmath}
\usepackage{graphicx}
\usepackage[colorlinks=true, allcolors=blue]{hyperref}

% Set document Font
\usepackage{fontspec}

\setmainfont{Times New Roman}

% Para las ecuaciones: https://latex.codecogs.com/eqneditor/editor.php?lang=es-es

\title{Proyecto Global Integrador AyME:\\
Control de Accionamiento de CA con Motor Sincrónico de Imanes Permanentes}

\author{Guarise Renzo, Trubiano Lucas\\
Profesor: Ing. Gabriel L. Julián\\
\\
Universidad Nacional de Cuyo - Facultad de Ingeniería\\
Automática y Máquinas Eléctricas\\
Ingeniería Mecatrónica}

\begin{document}
\maketitle

\begin{center} % Centrar texto
    {\Large \textbf{Resumen}}
\end{center}

En el presente proyecto se modelará, diseñará, analizará y simulará un sistema de control automático de posición y movimientos para un accionamiento electromecánico de 4 cuadrantes compuesto por una máquina eléctrica de corriente alterna (CA) trifásica sincrónica con excitación por imanes permanentes (PMSM), la cual es alimentada por un inversor trifásico desde una fuente ideal de corriente continua (CC) y un reductor de velocidad de engranajes planetarios de salida hacia la carga mecánica. Se dispone además un sensor de posición (encoder) en el eje del motor, 3 sensores de corriente instantánea de fases en la salida del inversor al estator y un sensor de temperatura del bobinado de estator. La carga mecánica es el brazo de un robot tipo SCARA, para el cual no se ha considerado la dinámica NL a modo de simplificación. Como primera instancia se modelará el sistema completo. Luego se hará un profundo análisis de este, estudiando sus no linealidades, acoplamientos y su comportamiento ante la incertidumbres en sus parámetros. Por último, se llevará a cabo una estrategia de control vectorial con campo orientado a partir de la cual se diseñará un controlador externo de movimiento en cascada con un modulador de torque.


% \tableofcontents % Creamos el indice

\section{Introducción}

Las máquinas eléctricas de CA tienen mejores prestaciones que las máquinas de CC, aun así su control es bastante complejo.
A pesar de eso, en los últimos años se han hecho varios avances para poder explotar todas las ventajas de las máquinas de CA, como su mayor robustez, menor mantenimiento y costo, mejor respuesta dinámica y mayor capacidad de carga.
Y es por esa razón que hoy en día se utilizan ampliamente en la industria, por lo que es muy interesante su estudio.
\\
\par
Presentaremos el control de una máquina de CA, específicamente un motor síncrono con imanes permanentes.
Vamos a dividir el desarrollo en dos grandes partes.
La primera parte, presenta el problema a resolver y se desarrolla el modelado, análisis y simulación dinámica a lazo abierto (sin control realimentado) para verificar que el sistema es estable.
La simulación permite analizar la respuesta dinámica en el dominio del tiempo.
Luego mediante el análisis de las matrices en el espacio de estados, se puede determinar si el sistema es completamente controlable y observable.
\\
\par
En la segunda parte, realizaremos el diseño, análisis y simulación de un controlador de \textbf{Movimiento en Cascada} con \textbf{Modulador de Torque} equivalente, es decir, un \textbf{Control Vectorial}.
Obteniendo diferentes resultados que permitirán observar los parámetros de operación (corriente, tensión, velocidad y torque).
Además, hay que tener en cuenta y verificar que estos parámetros no excedan los límites especificados de la máquina.
Finalmente, ajustaremos los parámetros en el Controlador y el Observador, para resolver de manera óptima y eficiente, el problema propuesto.
Como medidas del rendimiento y desempeño vamos a considerar, el seguimiento de consigna dada (en posición o velocidad), el rechazo a las perturbaciones y la que las variables estén entre los límites admisibles.

\section{Desarrollo}
\subsection{Modelado, Análisis y Simulación dinámica del SISTEMA FÍSICO a “Lazo Abierto” (Sin Controlador externo de Movimiento)}
\subsubsection{Modelo matemático equivalente (1 GDL) del subsistema mecánico completo}
En el sistema físico real hay varios subsistemas mecánicos los cuales detallaremos a continuación para luego hacer una combinación de todos estos en un único subsistema mecánico equivalente.

\begin{itemize}
	\item \textbf{Carga mecánica}\vspace{0.3cm}\\
	En lo que refiere al subsistema mecánico del brazo del robot y la carga mecánica aplicada al mismo, se puede modelar mediante la siguiente ecuación:
	\begin{equation}
		\label{eqn:cargaMecanica}
		J_{l}\cdot \dot{\omega }_{l}\left ( t \right )=T_{q}\left ( t \right )-b_{l}\cdot \omega_{l}\left ( t \right )-T_{l}\left ( t \right )
	\end{equation}
	\begin{equation}
		\omega_{l}\left ( t \right )\equiv \dot{q}_{l}\left ( t \right )= \dot{q}_1\left ( t \right )
	\end{equation}
	Donde $q_{1}(t)$ es la posición articular del hombro del robot, $J_{l}$ es el momento de inercia de todos los eslabones del robot referidos al hombro, $b_{l}$ es el coeficiente de amortiguamiento viscoso, $T_{l}$ es el torque de carga o perturbación y $T_{q}$ es el torque motor entregado a la salida de la caja reductora de engranajes.
	La inercia y el amortiguamiento son dos de los parámetros que varían según la posición de las articulaciones del robot, es decir, $J_{l}(q_{1}(t),q_{2}(t),...,q_{n}(t))$ y una función similar para $b_{l}$.
	En este caso, se considera un valor nominal para estos parámetros, y sus posibles variaciones máximas, pero sin estar relacionado directamente con las posiciones articulares del robot.
	
	\item \textbf{Tren de transmisión:}\vspace{0.3cm}\\
	El tren de transmisión del robot está formado por una caja reductora, reversible, de engranajes planetarios. Se asume acoplamiento \textbf{rígido}, sin elasticidad torsional y sin backlash (juego). Al considerar una transmisión ideal, las ecuaciones que la modelan son:
	\begin{equation}
		\label{eqn:relacionTransmision}
		\omega_{l}\left ( t \right )=\frac{1}{r}\cdot w_{m}\left ( t \right )
	\end{equation}
	\begin{equation}
		\label{eqn:torqueTransmision}
		T_{q}\left ( t \right )=r\cdot T_{d}\left ( t \right )
	\end{equation}
	Donde $\omega_{m}(t)$ es la velocidad angular del eje del rotor del motor, $T_{d}(t)$ es el torque de la máquina eléctrica (equivalente a una carga colocada en el eje del rotor) y $r$ es la relación de transmisión del reductor planetario.
	
	\item \textbf{Subsistema mecánico del motor:}\vspace{0.3cm}\\
	Por último tenemos el subsistema mecánico que modela el torque de salida de la máquina eléctrica. Las ecuaciones que modelan el sistema son las siguientes:
	\begin{equation}
		\label{eqn:sistMecanicoMotor}
		J_{m}\cdot \dot{\omega }_{m}\left ( t \right )=T_{m}\left ( t \right )-b_{m}\cdot \omega_{m}\left ( t \right )-T_{d}\left ( t \right )
	\end{equation}
	\begin{equation}
		\omega_{m}\left ( t \right )\equiv \dot{q}_{m}\left ( t \right )
	\end{equation}
	Donde $J_{m}$ es la inercia del rotor respecto a su propio eje, $b_{m}$ es la viscosidad del rotor y $T_{m}(t)$ es el torque electromecánico de la máquina eléctrica.

	\item \textbf{Modelo equivalente mecánico (1 GDL):}\vspace{0.3cm}\\
	A continuación vamos a hacer unas simplificaciones sobre las ecuaciones de los subsistemas mecánicos, con el fin de reducir la complejidad del problema y teniendo en cuenta como hipótesis, que la transmisión es totalmente rígida y sin backlash (juego).
    Esto significa, que todo el movimiento a la entrada del reductor, se transmite a la salida con una relación lineal. Con el torque, sucede lo mismo, hay una transmisión lineal y sin pérdidas de potencia (excepto por la fricción viscosa).

	Bajo estas hipótesis, despejamos $T_{d}$ de la ecuación \ref{eqn:torqueTransmision} y lo reemplazamos en la ecuación \ref{eqn:sistMecanicoMotor}:
	\begin{equation}
		\label{eqn:paso1sistMecanico}
		J_{m}\cdot \dot{\omega }_{m}\left ( t \right )=T_{m}\left ( t \right )-b_{m}\cdot \omega_{m}\left ( t \right )-\frac{T_{q}\left ( t \right )}{r}
	\end{equation}
	Luego, despejamos $T_{q}$ de la ecuación \ref{eqn:cargaMecanica} y lo reemplazamos en \ref{eqn:paso1sistMecanico}:
	\begin{equation}
		\label{eqn:paso2sistMecanico}
		J_{m}\cdot \dot{\omega }_{m}\left ( t \right )=T_{m}\left ( t \right )-b_{m}\cdot \omega_{m}\left ( t \right )-\frac{\left ( J_{l}\cdot \dot{\omega_{l}}+b_{l}\cdot \omega_{l}+T_{l} \right )}{r}
	\end{equation}
	Teniendo en cuenta la relación de la ecuación \ref{eqn:relacionTransmision}, la reemplazamos en \ref{eqn:paso2sistMecanico} y reacomodamos la expresión:
	\begin{equation}
		\label{eqn:paso3sistMecanico}
		\left ( J_{m}+\frac{J_{l}}{r^{2}} \right )\cdot \dot{\omega }_{m}\left ( t \right )=T_{m}\left ( t \right )-\left ( b_{m}+\frac{b_{l}}{r^{2}} \right )\cdot \omega_{m}\left ( t \right )-\frac{T_{l}}{r}
	\end{equation}
	Donde establecemos las siguientes equivalencias:
	\begin{equation}
		\label{eqn:Jeq}
		J_{m}+\frac{J_{l}}{r^{2}}=J_{eq}
	\end{equation}
	\begin{equation}
		\label{eqn:beq}
		b_{m}+\frac{b_{l}}{r^{2}}=b_{eq}
	\end{equation}
	\begin{equation}
		\label{eqn:Teq}
		\frac{T_{l}}{r}=T_{eq}
	\end{equation}
	Reemplazando \ref{eqn:Jeq}, \ref{eqn:beq} y \ref{eqn:Teq} en la ecuación \ref{eqn:paso3sistMecanico}, la expresión nos queda:
	\begin{equation}
		\label{sist:mecanico}
		J_{eq}\cdot \dot{\omega }_{m}\left ( t \right )=T_{m}\left ( t \right )-b_{eq}\cdot \omega_{m}\left ( t \right )-T_{eq}
	\end{equation}
	\begin{equation}
		\label{globalNL:omegaM}
		\omega_{m} \equiv \dot{\theta_{m}}
	\end{equation}
	Dicha ecuación se puede representar en diagrama de bloques, como se ve en la siguiente figura \ref{fig:ElectricoEquivalente} (área en color celeste).

\end{itemize}

\subsubsection{Modelo dinámico del sistema físico completo}

\begin{enumerate}
    \renewcommand{\theenumi}{\alph{enumi}} %Letras minúsculas
    \item \textbf{Modelo global no lineal (NL)}
    
    Para definir el modelo completo del sistema, ya abordamos la parte mecánica. Ahora veremos el resto de los subsistemas para terminar de definir el modelo completo de nuestro sistema físico.
	\begin{itemize}
		\item \textbf{Subsistema Electromagnético:}\vspace{0.3cm}\\
		El motor sincrónico trifásico de CA con excitación por imanes permanentes (PMSM) tiene el estator conectado en estrella (con bornes de fases abc) y neutro flotante en el centro de la estrella.
		El subsistema es un sistema \textbf{simétrico} y \textbf{equilibrado} (por su construcción física), con las tres corrientes de fase de igual amplitud y desfasadas 120 grados eléctricos.
		\vspace{0.3cm}\\
		Para modelar esta máquina, haremos uso de la \textbf{transformación de Park}\footnote[1]{\textbf{Transformación de Park:} forma invariante en módulo de resultante vectorial de variables base $f$} del circuito del estator, llegando así a un modelo idealizado equivalente en coordenadas eléctricas \textbf{qd0} fijas al rotor.
		La transformación de Park nos permite referenciar nuestras variables a un marco de referencia que gira junto al rotor de la máquina.
		Y como se trata de un sistema simétrico, luego del transitorio queda totalmente equilibrado, entonces podemos suponer que luego de ese pequeño transitorio $v_{0s}(t)$ tendrá como valor $0$ y se reduce significativamente el número de variables.
		\vspace{0.3cm}\\
		Las coordenadas eléctricas del entrehierro $qd0$, fijas al rotor (marco de referencia “sincrónico”) se definen como:
		\begin{equation}
			\dot{\theta_{r}}\left ( t \right )\equiv \omega_{r}\left ( t \right )\Leftrightarrow \theta_{r}\left ( t \right )=\int_{0}^{t}\omega_{r}\left ( \xi \right )\cdot d\xi + \theta_{r}\left ( 0 \right )
		\end{equation}
		\begin{equation}
			\theta_{r} \left ( t \right ) \equiv P_{p} \cdot \theta_{m} \left ( t \right )
		\end{equation}
		\begin{equation}
			\omega_{r}\left ( t \right )=P_{p}\cdot \omega_{m}\left ( t \right )
		\end{equation}
		El torque electromagnético viene dado por la ecuación:
		\begin{equation}
			\label{sist:electromagnetico}
			T_{m}\left ( t \right )=\frac{3}{2} \cdot P_{p} \cdot \left [ \lambda_{m}^{r'}+\left ( L_{d}-L_{q} \right )\cdot i_{ds}^{r} \left ( t \right ) \right ] \cdot i_{qs}^{r}\left ( t \right )
		\end{equation}
		Donde $\lambda_{m}^{r'}$ es el flujo magnético equivalente de imanes concatenado, por espiras del bobinado de estator,
		$L_{d}$ es la inductancia de eje directo del estator y $L_{q}$ es la inductancia de eje en cuadratura del estator (estas magnitudes son consideradas constantes para simplificar el modelo).
		El modelo equivalente del subsistema eléctrico en coordenadas de entrehierro, está dado por las siguientes ecuaciones, que hacen un balance de tensiones en el sistema $qd0$ solidario al rotor.
		\begin{equation}
			\label{sist:electrico1}
			v_{qs}^{r}\left ( t \right )=R_{s}\left ( t \right )\cdot i_{qs}^{r}\left ( t \right )+L_{q}\cdot \frac{\mathrm{d} i_{qs}^{r}\left ( t \right )}{\mathrm{d} t}+\left [ \lambda_{m}^{r'}+L_{d}\cdot i_{ds}^{r}\left ( t \right ) \right ]\cdot \omega_{r}\left ( t \right )
		\end{equation}
		\begin{equation}
			\label{sist:electrico2}
			v_{ds}^{r}\left ( t \right )=R_{s}\left ( t \right )\cdot i_{ds}^{r}\left ( t \right )+L_{d}\cdot \frac{\mathrm{d} i_{ds}^{r}\left ( t \right )}{\mathrm{d} t}-L_{q}\cdot i_{qs}^{r}\left ( t \right )\cdot \omega_{r}\left ( t \right )
		\end{equation}
		\begin{equation}
			\label{eqn:expresionNula}
			v_{0s}^{r}\left ( t \right )=R_{s}\left ( t \right )\cdot i_{0s}^{r}\left ( t \right )+L_{ls}\cdot \frac{\mathrm{d} i_{0s}^{r}\left ( t \right )}{\mathrm{d} t}
		\end{equation}
		Se parte del supuesto que el sistema eléctrico es \textbf{simétrico}, \textbf{equilibrado} y con \textbf{neutro flotante}.
		Lo que implica que $i_{0s}^{r}(t)$ típicamente tendrá un valor nulo, por ende su derivada también y así también la tensión $v_{0s}^{r}(t)$.
		Lo cual significa que la expresión \ref{eqn:expresionNula} se puede considerar nula, sin caer en errores.
		
		Este sistema se puede representar en diagramas de bloques en \textbf{Simulink} como se ve en la siguiente figura:
		\begin{figure}[h!]
			\centering
			\includegraphics[width=\textwidth]{2_1_2_ModeloElectricoEquivalente.png}
			\caption{\label{fig:ElectricoEquivalente} Diagrama en bloques de la planta completa en \textbf{Simulink} (con transformación de \textbf{Park})}
		\end{figure}

		\item \textbf{Subsistema Térmico:}\vspace{0.3cm}\\
		Para el análisis y modelado térmico de la máquina eléctrica, vamos a considerar sólo pérdidas resistivas por \textbf{Efecto Joule} en el bobinado del estator y despreciar pérdidas magnéticas. La transferencia de calor es por conducción y convección natural, sin ventilación forzada.

		La potencia de pérdidas en coordenadas $abc$ del estator está dada por:
		\begin{equation}
			P_{s\ perd}\left ( t \right )=R_{s}\left ( t \right )\cdot \left ( {i_{as}}^{2}\left ( t \right )+{i_{bs}}^{2}\left ( t \right )+{i_{cs}}^{2}\left ( t \right ) \right )
		\end{equation}
		Y en coordenadas $qd0$ fijas en rotor:
		\begin{equation}
			\label{eqn:potenciaDisipada}
			P_{s\ perd}\left ( t \right )=\frac{3}{2}\cdot R_{s}\left ( t \right )\cdot \left ( {i_{qs}^{r}}^{2}\left ( t \right )+{i_{ds}^{r}}^{2}\left ( t \right )+2\cdot {i_{0s}^{r}}^{2}\left ( t \right ) \right )
		\end{equation}
		Donde hay que tener en cuenta que la resistencia del estator $R_{s}$, varía con la temperatura según la expresión:
		\begin{equation}
			\label{eqn:variacionRs}
			R_{s}\left ( t \right )=R_{sREF}\cdot \left ( 1+\alpha_{Cu}\cdot \left ( {T_{s}}^{\circ}\left ( t \right )-{T_{sREF}}^{\circ} \right ) \right )
		\end{equation}
		El balance térmico entonces, queda dado por la siguiente ecuación:
		\begin{equation}
			\label{eqn:balanceTermico}
			P_{s\ perd}\left ( t \right )=C_{ts}\cdot \frac{\mathrm{d} {T_{s}}^{\circ}\left ( t \right )}{\mathrm{d} t}+\frac{1}{R_{ts-amb}}\cdot \left ( T_{s}^{\circ}\left ( t \right )-T_{amb}^{\circ}\left ( t \right ) \right )
		\end{equation}

		\item \textbf{Dinámica del modelo global NL:}\vspace{0.3cm}\\
		Teniendo en cuenta la ecuación \ref{globalNL:omegaM}; reemplazando \ref{sist:electromagnetico} en \ref{sist:mecanico}; reacomodando las ecuaciones \ref{sist:electrico1}, \ref{sist:electrico2} y \ref{eqn:expresionNula}; reemplazando \ref{eqn:potenciaDisipada} en \ref{eqn:balanceTermico} y reacomodando; y considerando la ecuación \ref{eqn:variacionRs} el modelo dinámico \textbf{global NL} del sistema nos queda:
		
		
		\begin{equation}
			\label{eqn:sistGlobalNL}
			\begin{cases}
				\dot{\theta_{m}}(t)=\omega_{m}(t)
				\\
				\\
				\dot{\omega }_{m}\left ( t \right )=\frac{3}{2}\cdot\frac{P_{p}}{J_{eq}}\cdot [ \lambda_{m}^{r'}+\left ( L_{d}-L_{q} \right )\cdot i_{ds}^{r} (t)]\cdot i_{qs}^{r}(t)-\frac{b_{eq}}{J_{eq}}\cdot\omega_{m}(t)-\frac{T_{eq}(t)}{J_{eq}}
				\\
				\\
				\frac{\mathrm{d} i_{qs}^{r}\left ( t \right )}{\mathrm{d} t}=\frac{v_{qs}^{r}(t)}{L_{q}}-\frac{R_{s}\left ( t \right )}{L_{q}}\cdot i_{qs}^{r}(t)-\frac{P_{p}}{L_{q}}\cdot [ \lambda_{m}^{r'}+L_{d}\cdot i_{ds}^{r}(t) ]\cdot \omega_{m}(t)
				\\
				\\
				\frac{\mathrm{d} i_{ds}^{r}\left ( t \right )}{\mathrm{d} t}=\frac{v_{ds}^{r}(t)}{L_{d}}-\frac{R_{s}\left ( t \right )}{L_{d}}\cdot i_{ds}^{r}(t)+\frac{P_{p}\cdot L_{q}}{L_{d}}\cdot i_{qs}^{r}(t)\cdot \omega_{m}(t)
				\\
				\\
				\frac{\mathrm{d} i_{0s}^{r}\left ( t \right )}{\mathrm{d} t}=\frac{v_{0s}^{r}(t)}{L_{ls}}-\frac{R_{s}\left ( t \right )}{L_{ls}}\cdot i_{0s}^{r}\left ( t \right )
				\\
				\\
				\frac{\mathrm{d} {T_{s}}^{\circ}\left ( t \right )}{\mathrm{d} t}=\frac{\frac{3}{2}\cdot R_{s}\left ( t \right )\cdot \left ( {i_{qs}^{r}}^{2}\left ( t \right )+{i_{ds}^{r}}^{2}\left ( t \right )+2\cdot {i_{0s}^{r}}^{2}\left ( t \right ) \right )-\frac{T_{s}^{\circ}\left ( t \right )-T_{amb}^{\circ}\left ( t \right )}{R_{ts-amb}}}{C_{ts}}
				\\
				\\
				R_{s}\left ( t \right )=R_{sREF}\cdot \left ( 1+\alpha_{Cu}\cdot \left ( {T_{s}}^{\circ}\left ( t \right )-{T_{sREF}}^{\circ} \right ) \right )
			\end{cases}
		\end{equation}
		Este modelo contiene varias \textbf{no linealidades} al contener productos de variables de estado y también al depender varias de esas ecuaciones de $R_{s}$, que a su vez depende de la temperatura ${T_{s}}^{\circ}$ que es una variable de estado que varía en el tiempo $t$.
		\\
		\\
		Este modelo \textbf{NL} puede ser representado mediante diagramas de bloques en \textbf{Simulink} como se observa en la figura \ref{fig:ElectricoEquivalente}.

	\end{itemize}
	%% Esto lo puse porque sino la imagen quedaba mal acomodada, ver si al completar lo primero hace falta o ya no. !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
  

	\item \textbf{Linealización Jacobiana}
    \vspace{0.3cm} 
    \\Primero obtendremos el modelo \textbf{global linealizado con parámetros variables (LPV)}, para $ i_{ds}^{r}\left( t \right ) \neq 0 $ (caso gral.). 
    Un sistema \textbf{no lineal} puede ser representado por:
    \begin{equation}
		\begin{cases}
			\dot{x}\left ( t \right )= f\left ( x\left ( t \right ),u\left ( t \right ),t \right ) \ \ \ ,\ \ \ x\left ( t_{0} \right )=x_{0}
			\\
			y\left ( t \right )= C \cdot x\left ( t \right )
		\end{cases}
    \end{equation}
    donde $f$ es una función vectorial \textbf{NL} de $n\times 1$ elementos que está en función del vector de estados $x$.
    El número $n$ es el orden del sistema y la solución de $x(t)$ representa una curva en el espacio de estado \textbf{(trayectoria de estado)}.
    Asumiendo que $f$ no varía con el tiempo $t$ y  que cada variable se pueden expresar como
    \begin{equation}
        z\left ( t \right )\equiv Z_{0} + \Delta z\left ( t \right )
    \end{equation}
    donde $Z_{0}$ es una magnitud cuasi-estacionaria de variaciones lentas en el tiempo \textbf{(baja dinámica)} y $\Delta z(t)$ una magnitud pequeña de variación rápida en el tiempo \textbf{(alta dinámica)}.
    El sistema queda expresado por:
    \begin{equation}
        \begin{cases}
            \frac{\mathrm{d} X_{o}\left ( t \right )}{\mathrm{d} t}+
            \frac{\mathrm{d} \Delta x\left ( t \right )}{\mathrm{d} t}
            =
            f\left ( X_{o}\left ( t \right )+\Delta x\left ( t \right ),U_{o}\left ( t \right )+\Delta u\left ( t \right ) \right )
            \ \ \rightarrow \ \ 
            X_{o}\left ( 0 \right )=x_{0}\ \ ;\ \ \ \Delta x\left ( 0 \right )=0
			\\
			\\
			Y_{o}(t)+\Delta y(t)=C\cdot (X_{o}\left ( t \right )+\Delta x\left ( t \right ))
			\ \ \rightarrow \ \ 
			Y_{o}\left ( t \right )=C\cdot X_{o}(t)\ \ ;\ \ \ \Delta y\left ( t \right )=C\cdot \Delta x\left ( t \right )
        \end{cases}
    \end{equation}
	Expresando mediante expansión por series de \textbf{Taylor truncada a 1° orden}, podemos plantear:
	\begin{equation}
		\begin{array}{l}
			\textcolor{red}{f(} X_{o}(t)+\Delta x(t),U_{o}(t)+\Delta u(t) \textcolor{red}{)} \approx \dots
			\\
			\\
			\ \ \ \ 
			\textcolor{red}{f( X_{o}(t),U_{o}(t) )}+
			\left.\begin{matrix}
				\begin{bmatrix}
					\frac{\partial f}{\partial x_{1}} & \dots & \frac{\partial f}{\partial x_{n}}
				\end{bmatrix}
			\end{matrix}\right|_{0}(t)\cdot \Delta x(t)+
			\left.\begin{matrix}
				\begin{bmatrix}
					\frac{\partial f}{\partial u_{1}} & \dots & \frac{\partial f}{\partial u_{n}}
				\end{bmatrix}
			\end{matrix}\right|_{0}(t)\cdot \Delta u(t)
		\end{array}
	\end{equation}
	A continuación vamos a separar el modelo en dos partes, \textbf{Espacio Global de Puntos de Operación + Modelo Dinámico Local de Pequeñas Desviaciones}.
	En el caso de que el punto de operación esté fijo, tendremos un sistema LTI; en cambio si este varía, tendremos un sistema LTV.
	\\
	El espacio global de puntos de operación se obtiene de la solución del sistema de ecuaciones no lineales definido por la ecuación:
	\begin{equation}
		\label{eqn:equilibrioDinamico}
		\frac{\mathrm{d} X_{o}(t)}{\mathrm{d} t}=f(X_{o}(t),U_{o}(t))\approx 0/const
	\end{equation}
	Si aplicamos la ecuación \ref{eqn:equilibrioDinamico} a la ecuación \ref{eqn:sistGlobalNL} de nuestro modelo, obtenemos el siguiente sistema de ecuaciones:
	\begin{equation}
		\label{eqn:equilibrioDinamicoSistema}
		\begin{cases}
			cte. \simeq \Omega_{mo}(t)
			\\
			\\
			0 \simeq \frac{3}{2} \cdot \frac{ P_{p}}{J_{eq}}\cdot \left [ \lambda_{m}^{r'}+\left ( L_{d}-L_{q} \right )\cdot I_{dso}^{r} \left ( t \right ) \right ] \cdot I_{qso}^{r}\left ( t \right )-\frac{b_{eq}}{J_{eq}}\cdot \Omega_{mo}\left ( t \right )-\frac{T_{eqo}(t)}{J_{eq}}
			\\
			\\
			0 \simeq \frac{V_{qso}^{r}(t)}{L_{q}}-\frac{R_{so}(t)}{L_{q}}\cdot I_{qso}^{r}(t)-\frac{P_{p}}{L_{q}}\cdot [ \lambda_{m}^{r'}+L_{d}\cdot I_{dso}^{r}(t) ]\cdot \Omega_{mo}(t)
			\\
			\\
			0 \simeq \frac{V_{dso}^{r}(t)}{L_{d}}-\frac{R_{so}\left ( t \right )}{L_{d}}\cdot I_{dso}^{r}(t)+\frac{P_{p}\cdot L_{q}}{L_{d}}\cdot I_{qso}^{r}(t)\cdot \Omega_{mo}(t)
			\\
			\\
			0 \simeq \frac{V_{0so}^{r}(t)}{L_{ls}}-\frac{R_{so}\left ( t \right )}{L_{ls}}\cdot I_{0so}^{r}(t)
			\\
			\\
			0 \simeq \frac{\frac{3}{2}\cdot R_{so}(t)\cdot \left ( {I_{qso}^{r}}^{2}(t)+{I_{dso}^{r}}^{2}(t)+2\cdot {I_{0so}^{r}}^{2}(t) \right )-\frac{T_{so}^{\circ}\left ( t \right )-T_{amb}^{\circ}\left ( t \right )}{R_{ts-amb}}}{C_{ts}}
			\\
			\\
			R_{so}(t)=R_{sREF}\cdot \left ( 1+\alpha_{Cu}\cdot \left ( {T_{so}}^{\circ}\left ( t \right )-{T_{sREF}}^{\circ} \right ) \right )
		\end{cases}
	\end{equation}
	Este sistema de ecuaciones representa un \textbf{``equilibrio"\  dinámico} cuasi-estacionario del sistema. Por otro lado, alrededor de los puntos de operación nuestro modelo dinámico local de pequeñas desviaciones viene dado por la ecuación:
	\begin{equation}
		\label{eqn:pequeniasDesviaciones}
		\frac{\mathrm{d} \Delta x(t)}{\mathrm{d} x}=
		\begin{bmatrix}
			\left.\begin{matrix}
				\frac{\partial f}{\partial x}
			\end{matrix}\right|_{0}(t)
		\end{bmatrix}\cdot\Delta x(t)+
		\begin{bmatrix}
			\left.\begin{matrix}
				\frac{\partial f}{\partial u}
			\end{matrix}\right|_{0}(t)
		\end{bmatrix}\cdot\Delta u(t)
		\ \ ;\ \ \Delta x(0)=0
	\end{equation}
	Si aplicamos la ecuación \ref{eqn:pequeniasDesviaciones} a la ecuación \ref{eqn:sistGlobalNL} de nuestro modelo, obtenemos el siguiente sistema de ecuaciones del modelo dinámico LPV (pequeñas variaciones locales):
	\newline
	\begin{equation}
		\label{eqn:sistPequeniasDesviaciones}
		\begin{cases}
			\Delta\dot{\theta}_{m}(t)=\Delta\omega_{m}(t)
			\\
			\\
			\Delta\dot{\omega }_{m}(t)=\frac{3 P_{p}}{2 J_{eq}}\cdot \left [[\lambda_{m}^{r'}+\left ( L_{d}-L_{q} \right )\cdot I_{dso}^{r} (t)]\cdot\Delta i_{qs}^{r}(t)+[\left ( L_{d}-L_{q} \right )\cdot I_{qso}^{r}(t)]\cdot\Delta i_{ds}^{r} (t)\right ]\dots \\  \ \ \ \ \ \ \  \  \ \  \ \  \ \ \ \ - \frac{b_{eq}}{J_{eq}}\cdot\Delta\omega_{m}(t)-\frac{\Delta T_{eq}(t)}{J_{eq}}
			\\
			\\
			\frac{\mathrm{d} \Delta i_{qs}^{r}\left ( t \right )}{\mathrm{d} t}=\frac{\Delta v_{qs}^{r}(t)}{L_{q}}-\left [ \frac{R_{so}\left ( t \right )}{L_{q}}\cdot \Delta i_{qs}^{r}(t)+\frac{\Delta R_{s}(t)}{L_{q}}\cdot I_{qso}^{r}(t) \right ]\dots \\ \ \ \ \ \ \ \  \  \ \  \ \  \ \ \ \ -\frac{P_{p}}{L_{q}}\cdot\left [[\lambda_{m}^{r'}+L_{d}\cdot I_{dso}^{r}(t)]\cdot\Delta \omega_{m}(t)+[L_{d}\cdot \Omega_{mo}(t)]\cdot \Delta i_{ds}^{r}(t)\right ]
			\\
			\\
			\frac{\mathrm{d}\Delta i_{ds}^{r}\left ( t \right )}{\mathrm{d} t}=\frac{\Delta v_{ds}^{r}(t)}{L_{d}}-\left [ \frac{R_{so}\left ( t \right )}{L_{d}}\cdot \Delta i_{ds}^{r}(t)+\frac{\Delta R_{s}\left ( t \right )}{L_{d}}\cdot I_{dso}^{r}(t) \right ]\dots \\ \ \ \ \ \ \ \  \  \ \  \ \  \ \ \ \ +\frac{P_{p}\cdot L_{q}}{L_{d}}\cdot\left [  I_{qso}^{r}(t)\cdot \Delta\omega_{m}(t)+\Delta i_{qs}^{r}(t)\cdot \Omega_{mo}(t) \right ]
			\\
			\\
			\frac{\mathrm{d}\Delta i_{0s}^{r}\left ( t \right )}{\mathrm{d} t}=\frac{\Delta v_{0s}^{r}(t)}{L_{ls}}-\left [ \frac{R_{so}\left ( t \right )}{L_{ls}}\cdot \Delta i_{0s}^{r}(t)+\frac{\Delta R_{s}\left ( t \right )}{L_{ls}}\cdot I_{0so}^{r}(t) \right ]
			\\
			\\
			\frac{\mathrm{d} {\Delta T_{s}}^{\circ}\left ( t \right )}{\mathrm{d} t}=\frac{3R_{so}(t)}{C_{ts}}\cdot \left [ I_{qso}^{r} \cdot \Delta i_{qs}^{r}+I_{dso}^{r} \cdot \Delta i_{ds}^{r}+2I_{0so}^{r} \cdot \Delta i_{0s}^{r} \right ]+\frac{3\Delta R_{s}(t)}{2 C_{ts}}\cdot\left [ {I_{qso}^{r}}^{2}+{I_{dso}^{r}}^{2}+2\cdot{I_{0so}^{r}}^{2} \right ]\dots \\ \ \ \ \ \ \ \  \  \ \  \ \  \ \ \ \ -\frac{\left [\Delta T_{s}^{\circ}\left ( t \right )  - \Delta T_{amb}^{\circ}\left ( t \right ) \right ]}{R_{ts-amb}\cdot C_{ts}}
			\\
			\\
			\Delta R_{s}( t )=R_{sREF}\cdot\alpha_{Cu}\cdot {\Delta T_{s}}^{\circ}( t )
		\end{cases}
	\end{equation}
	El modelo global NL dado por la ecuación \ref{eqn:sistGlobalNL}, se puede linealizar por series de Taylor truncadas al primer orden obteniendo 
	un modelo lineal dado por la ec. \ref{eqn:sistPequeniasDesviaciones} alrededor de puntos de operación definidos por la ec. \ref{eqn:equilibrioDinamicoSistema} con estado inicial genérico.

    \item \textbf{Linealización por Realimentación NL}
    \begin{itemize}
    
	\item\textbf{ Modelo simplificado lineal invariante (LTI) equivalente}.
	
	A continuación se presenta el modelo (LTI) en espacio de estado obtenido del modelo NL completo (ec. \ref{eqn:sistGlobalNL}), considerando que la corriente $i^{r}_{ds}$ en directo con el campo magnético principal generado por imanes permanentes es nula, la resistencia en los devanados del estator es constante con la temperatura, el sistema es equilibrado y simétrico, por lo que $i^{r}_{0s}=0$ y que el modelo del subsistema térmico es lineal.\\
	Definimos el vector de estados $X(t)$ (ec.\ref{eq:2.1.2.c.1}), la perturbación $d(t)$ (ec.\ref{eq:2.1.2.c.3}) y el vector de entradas $u(t)$ (ec.\ref{eq:2.1.2.c.2}) :
	\begin{equation}
		X(t)=\begin{bmatrix}
			\theta_{m}(t)\\
			\omega_{m}(t) 
			\\ 
			i^{r}_{qs}(t)\\
			T°_{s}(t)
		\end{bmatrix}
		\label{eq:2.1.2.c.1}
	\end{equation}
		\begin{equation}
		d(t)=\frac{T_{l}(t)}{r} 
		\label{eq:2.1.2.c.3}
	\end{equation}
	
	\begin{equation}
		u(t)=\begin{bmatrix}
			v^{r}_{qs} (t)\\
			d(t)\\
			P_{s perd}(t)\\
			T°_{amb}(t) 
		\end{bmatrix}
		\label{eq:2.1.2.c.2}
	\end{equation}

	Así el modelo LTI en el espacio de estados es el siguiente  :
	
	\begin{equation}
	\begin{cases}
	\dot{X}(t)=\begin{bmatrix}
	0 & 1 &0 &0\\ 
	0 & -\frac{b_{eq}}{J_{eq}} & \frac{3 P_{p} \lambda^{r'}_{m}}{2 J_{eq}} & 0\\ 
	0  & \frac{- P_{p} \lambda^{r'}_{m}}{ L_{q}} & \frac{-R_{s}}{L_{q}} & 0\\
	0 & 0 & 0 & -\frac{1}{R_{ts-amb} C_{ts}}
	\end{bmatrix}\cdot X(t) + \begin{bmatrix}
	0 &0 &0 &0\\ 
	0 &\frac{-1}{J_{eq}} &0 &0\\ 
	 \frac{1}{L_{q}}&0 &0 & 0\\
	0 & 0 & \frac{1}{C_{ts}} & \frac{1}{R_{ts-amb} C_{ts}}
	\end{bmatrix} 
	\cdot u(t); \\
	X(t_{0})=x_{0}\\ 
	y(t)=[1 \ \ 0 \ \ 0 \ \ 1] \cdot X(t)
	\end{cases}
	\label{eq:2.1.2.c.4}
	\end{equation}
	Es importante notar que con estas restricciones obtenemos un sistema algebraico completamente lineal, la matriz de coeficientes \textbf{A} es constante, además el torque electromagnético (ec. \ref{sist:electromagnetico}) dependerá solamente de $i^{r}_{qs}$ y la tensión inducida en el eje en cuadratura q (ec. \ref{sist:electrico1}) dependerá solamente de $w_{m}$.
	En la figura \ref{fig:diagLTI} se muestra el diagrama de bloques en forma desagregada del sistema (rosado). Como vemos imponiendo la restricción $i^{r}_{ds}=0$ el sistema toma la forma de un motor de corriente continua.
	\begin{figure}[h!]
		\centering
		\includegraphics[width=0.85\textwidth]{DiagramabloquesLTI.png}
		\caption{\label{fig:diagLTI} Diagrama de bloques de estado del modelo simplificado lineal invariante (LTI) equivalente en \textbf{Simulink}. Con dinámica residual (rojo) y sin dinámica residual (rosado). }
	\end{figure}

	\item\textbf{ Restricción o Ley de Control mínima}.\\
	Para lograr una $i^{r}_{ds}$ nula y así obtener el modelo LTI desarrollado en el punto anterior debemos aplicar sobre el eje de la ley de control expresada por la ec. \ref{eq:2.1.2.d.1}.
	\begin{equation}
	v^{r}_{ds}(t)=-L_{q}\cdot i^{r}_{qs}(t)\cdot P_{p}\cdot \omega_{m}(t)\ ; i^{r}_{ds}(t_{0})=0
	\label{eq:2.1.2.d.1}
	\end{equation}
	
	Esta restricción se obtiene al imponer la condición $i^{r}_{ds}\equiv 0$ en la ec.\ref{sist:electrico2}, lo que define una ecuación algebraica que representa una restricción sobre $v^{r}_{ds}(t)$.
	Así $v^{r}_{ds}(t)$ deja de ser una variable manipulada. Como podemos ver se ha considerado que la condición inicial de $i^{r}_{ds}$ es nula, ya que si esta no lo fuera tendríamos una dinámica residual de la corriente $i^{r}_{ds}$ lo que provocaría que el modelo no sea lineal en los instantes iniciales, esto lo desarrollaremos en detalle más adelante.
	Por otro lado para implementar esta ley de control es necesario realimentar a nuestro controlador con las variables de estado $i^{r}_{qs}$ y $\omega_{m}$, y que este genere una consigna de tensiones de fase consistente con dicha restricción.
	Para ello en el controlador se implementa una transformación directa de Park para así poder trabajar con las variables en el sistema $qd0s$, ya que, de la planta sensamos las corrientes $i_{abcs}$, así generamos nuestras consignas de tensiones $v^{r}_{qd0s}$ y luego mediante una transformación inversa de Park obtenemos las consignas de tensiones de fase $v_{abcs}$, capaces de reproducir dicha restricción, y estas consignas de tensiones se generarán mediante el modulador de tensión, conmutado con modulación de ancho de pulso PWM, en este análisis el modulador de tensión se idealiza considerando solamente las componentes fundamentales, sin armónicos de las ondas de tensión.
	Esta técnica se denomina \textbf{linealización por realimentación directa no lineal de estado parcial} y obtenemos así el modelo \textbf{NL desacoplado con Ley de control NL}.\\
    En el diagrama de bloques del modelo NL (figura \ref{fig:ElectricoEquivalente}) podemos observar en rojo el desacoplamiento que esta restricción impone.\\
    En la figura \ref{fig:diagrestriccionminima} se puede ver la implementación de esta ley de control en color rojo dentro del controlador parcial.

	
	\begin{figure}[h!]
	\centering
	\includegraphics[width=\textwidth]{realimentacionNL.png}
	\caption{\label{fig:diagrestriccionminima} Implementación controlador parcial con restricción mínima (rojo) y con restricción complementaria (naranja). Planta (verde), sensores(magenta), controlador parcial (celeste clarito).}
	\end{figure}
	
	\item\textbf{Dinámica residual en el eje d}\\
	El modelo de la dinámica residual para $i^{r}_{ds}$ al aplicar la ley de control mínima para el caso de que $i^{r}_{ds}(0)\neq 0$ se muestra en la ec.\ref{eq:2.1.2.e.1} y aplicando la transformada de Laplace, su respuesta natural está dada por la ec.\ref{eq:2.1.2.e.2}.
	\begin{equation}
	\frac{di^{r}_{ds}}{dt}=-\frac{R_{s}}{L_{d}}\ i^{r}_{ds}(t)
	\label{eq:2.1.2.e.1}
	\end{equation}
	\begin{equation}
	\frac{I^{r}_{ds}(s)}{I^{r}_{ds 0}}=\frac{1}{s+\frac{R_{s}}{L_{d}}}
	\label{eq:2.1.2.e.2}
	\end{equation}
	
	Vemos que la dinámica residual tiene la forma de una ecuación diferencial monótona descendente con un cero en $s=-154.55\ \frac{rad}{s}$, si consideramos a $Rs$ constante e igual a $1.02\ \Omega$.
	Por lo que podemos concluir que ante un estado inicial distinto de cero la corriente en el eje de va a tender rápidamente a cero.
	Si incorporamos esta dinámica residual a nuestro modelo LTI (ec.\ref{eq:2.1.2.c.4}) obtenemos:
		\begin{equation}
		X(t)=\begin{bmatrix}
			\theta_{m}(t)\\
			\omega_{m}(t) 
			\\ 
			i^{r}_{qs}(t)\\
			T°_{s}(t)\\
		i^{r}_{ds}
		\end{bmatrix}
		\label{eq:2.1.2.e.3}
	\end{equation}

	\begin{equation}
	\begin{cases}
	\dot{X}(t)=\begin{bmatrix}
	0 & 1 &0 &0&0\\ 
	0 & -\frac{b_{eq}}{J_{eq}} & \frac{3 P_{p} \lambda^{r'}_{m}}{2 J_{eq}} & 0&0\\ 
	0  & \frac{- P_{p} \lambda^{r'}_{m}}{ L_{q}} & \frac{-R_{s}}{L_{q}} & 0&0\\
	0 & 0 & 0 & -\frac{1}{R_{ts-amb} C_{ts}}&0\\
	0&0&0&0&-\frac{R_{s}}{L_{d}}
	\end{bmatrix}\cdot X(t) + \begin{bmatrix}
	0 &0 &0 &0\\ 
	0 &\frac{-1}{J_{eq}} &0 &0\\ 
	 \frac{1}{L_{q}}&0 &0 & 0\\
	0 & 0 & \frac{1}{C_{ts}} & \frac{1}{R_{ts-amb} C_{ts}}\\
	0 &0 &0 &0
	\end{bmatrix} 
	\cdot u(t); \\
	X(t_{0})=x_{0}\\ 
	y(t)=[1 \ \ 0 \ \ 0 \ \ 0 \ \ 0]\cdot \ X(t)
	\end{cases}
	\label{eq:2.1.2.e.4}
	\end{equation}
	

	

	Donde vemos que ahora nuestro vector de estado (ec.\ref{eq:2.1.2.e.3}) tiene un estado más y las entradas son las definidas por la ec.\ref{eq:2.1.2.c.2}. Como podemos ver, ahora $i^{r}_{ds}$ puede ser distinta de cero, sin embargo no se ha considerado el \textbf{acoplamiento residual NL con el eje q} dado por la ec. \ref{eq:2.1.2.e.5} y esto se debe a que como comentamos más arriba la dinámica residual de este eje es monótona descendiente por lo que rápidamente $i^{r}_{ds}$ decae a cero, por ende, en régimen forzado esta no va a tener influencia sobre el \textbf{eje q}.
	
	\begin{equation}
	v^{r*}_{qs}(t)=L_{d}. i^{r}_{ds}(t).P_{p}.\omega_{m}(t)
	\label{eq:2.1.2.e.5}
	\end{equation}
	
	En la figura \ref{fig:diagLTI} se puede apreciar el modelo LTI considerando la dinámica residual del eje d (rojo).
	
	   \item\textbf{Ley de Control complementaria mínima en el eje q}.\\
	    Para eliminar completamente este acoplamiento residual NL aún en régimen natural y obtener un modelo equivalente completamente lineal, independiente del estado inicial de $i^{r}_{ds}$ se debe realimentar al sistema con la ley de control dada por la ec.\ref{eq:2.1.2.e.5}.
		En la figura \ref{fig:diagrestriccionminima} se puede apreciar el controlador parcial con la implementación de esta restricción en color naranja, obteniendo así el modelo \textbf{LTI equivalente aumentado} el cual aplica la ley de control mínima en el eje d y la ley de control complementaria en el eje q.\\
	    En el diagrama de bloques del modelo NL completo (figura \ref{fig:ElectricoEquivalente}) podemos observar en naranja el desacoplamiento que esta realimentación produce.
		Así el modelo \textbf{LTI equivalente aumentado} realiza el desacoplamiento de la realimentación en rojo y en naranja, mientras que el modelo \textbf{NL desacoplado con Ley de control NL} realiza solamente el desacoplamiento en rojo. \\
	\end{itemize}
	
	\item \textbf{Comparación del modelo dinámico LTI equivalente aumentado vs. el modelo LPV forzando $I^{r}_{ds_{0}} \equiv 0$}.\\
	Si forzamos $\Delta i^{r}_{ds} \equiv 0$ para lo cual  $\Delta v^{r}_{ds}(t)=-\frac{P_{p}\cdot L_{q}}{L_{d}}\cdot\left [  I_{qso}^{r}(t)\cdot \Delta\omega_{m}(t)+\Delta i_{qs}^{r}(t)\cdot \Omega_{mo}(t) \right ]$, consideramos $R_{s}$ constante y el modelo del subsistema térmico lineal, el modelo LPV se caracteriza por la ecuación \ref{eq:2.1.2.f.1}, donde no se ha incorporado el vector de entradas por una cuestión de espacio, además no es relevante para el análisis.
	 
	\begin{equation}
		\begin{bmatrix}
			\Delta \dot{\theta}_{m}(t)\\
			\Delta \dot{\omega}_{m}(t)
			\\ 
			\frac{d \Delta i^{r}_{qs}(t)}{dt}\\
			\Delta \dot{T}_{s}(t)\\
		\end{bmatrix}
		=
		\begin{bmatrix}
			0 & 1 &0 &0  \\ 
			0 & -\frac{b_{eq}}{J_{eq}} & \frac{3 P_{p}}{2 J_{eq}}[ \lambda^{r'}_{m}+\left ( L_{d}-L_{q} \right )\cdot I_{dso}^{r} (t)]&0 \\ 
			0  & \frac{- P_{p} }{ L_{q}} [\lambda^{r'}_{m}+L_{d}\cdot I^{r}_{ds0}(t)]& \frac{-R_{s}}{L_{q}}&0\\
			0 & 0 & 0 & -\frac{1}{R_{ts-amb} C_{ts}}\\
		\end{bmatrix} 
	\begin{bmatrix}
	\Delta \theta_{m}(t)\\
	\Delta \omega_{m}(t)
	\\ 
	\Delta i^{r}_{qs}(t)\\
	\Delta T_{s}(t)
	\end{bmatrix}
	\label{eq:2.1.2.f.1}
	\end{equation}
	
	Aplicando estas restricciones y forzando $I^{r}_{ds0} \equiv 0$, vemos que las matrices del modelo LPV ahora no varían con el tiempo por lo que tenemos un modelo LTI en las cercanías del punto de operación, además podemos observar que las matrices son iguales a las del \textbf{modelo LTI equivalente aumentado} por lo que podríamos decir que este último es un caso particular  del \textbf{modelo dinámico global LPV} para un punto de operación $I^{r}_{ds0} \equiv 0$ con $\Delta i^{r}_{ds} \equiv 0$.
	Como se podrá observa en estas ecuaciones no se ha considerado la \textbf{dinámica residual del eje d} ante $i^{r}_{ds}(0)\neq 0$ ni tampoco el \textbf{acoplamiento residual NL en eje q}, ya que por motivos que ya sabemos se puede despreciar sin caer en grandes errores, pero además al realizar la linealización Jacobiana se le asigna todo el estado inicial de las variables de estado a los puntos de operación, por ende $\Delta i^{r}_{ds}(0) \equiv 0$.\\
	Evaluaremos el comportamiento del sistema para distintos puntos de operación $I^{r}_{ds_{0}}\neq 0$.
	Por la ecuación del torque electromagnético (ec. \ref{sist:electromagnetico}) y recordando que estamos trabajando con una máquina de polos salientes, por lo que $L_{d}$ > $L_{q}$ , se pueden deducir tres casos:
	
	\begin{enumerate}
	\item $I^{r}_{ds0}(t)=0$: el flujo concatenado está afectado únicamente por los imanes permanentes.
	\item $I^{r}_{ds0}(t)>0$: reforzamiento del campo principal, se logra un mayor torque.
	\item $I^{r}_{ds0}(t)<0$: debilitamiento del campo principal, se logra un menor torque.
	\end{enumerate}
	
	Estos cambios en el par de la máquina tendrán efectos sobre la velocidad de la misma, ya que si el sistema es considerado de potencia constante, sucederá que un aumento en el par provoca una disminución en la velocidad angular de la máquina y viceversa.

	También veamos que cuando cambia $I^{r}_{ds0}(t)\neq 0$ se produce una migración de los parámetros de la matriz A (ecuación \ref{eq:2.1.2.f.1}) que influyen sobre $\omega_{m}$ (velocidad) e $i^{r}_{qs}$, además se produce también una migración de los puntos de operación $I^{r}_{qs0}(t)$ y $\Omega_{m0}$.
	% Y se puede observar que dependiendo del valor de $\omega_{m}$ este acoplamiento puede tener el efecto contrario que el explicado anteriormente sobre el torque.
	% Es decir, por ejemplo, si la velocidad y el torque son positivos, y además no se tienen perturbaciones, y afecto al sistema con un valor $I^{r}_{ds0}(t)>0$, esta va disminuir la corriente $i^{r}_{qs}$ y en mayor medida $(L_{d})$ que con la que aumenta el torque $(L_{d}-L_{q})$, por ende el efecto va a ser el contrario, se va a producir un debilitamiento en el torque.
	Se concluye entonces que si no se desacopla la influencia de $i^{r}_{ds}$ en el eje q, una $i^{r}_{ds}\neq 0$, no sólo va a producir un cambio sobre el torque, sino que también va a cambiar notablemente la dinámica del sistema (matriz A) y también va a influir considerablemente sobre el punto de operación $I^{r}_{qs0}$.\\

	\item \textbf{Función de Transferencia}.
	
	Se desarrollará la función de transferencia para el modelo LTI equivalente aumentado, desde ambas entradas $v^{r}_{qs}(t)$ y $T_{l}$ hacia la salida $\omega_{m}(t)$.\\
	Para obtener esta función partimos de la ecuación \ref{eq:2.1.2.e.4} y le aplicamos la transformada de Laplace a las ecuaciones que representan a $i^{r}_{qs}$ y a $\omega_{m}$ obteniendo:
	\begin{equation}
	i^{r}_{qs}(s).s.L_{q}=V_{qs}(s)-R_{s}.i^{r}_{qs}(s)-\lambda^{r'}_{m}.P_{p}\omega_{m}(s)
	\label{eq:2.1.2.ff.1}
	\end{equation}
	\begin{equation}
	J_{eq}.s.\omega_{m}(s)=\frac{3}{2}.P_{p}.\lambda^{r'}_{m}.i^{r}_{qs}(s)-b_{eq}.\omega_{m}(s)-T_{leq}(s)
	\label{eq:2.1.2.ff.2}
	\end{equation}
	
Despejando $i^{r}_{qs}(s)$ de la ec.\ref{eq:2.1.2.ff.1}, reemplazando en la ec.\ref{eq:2.1.2.ff.2} y reordenando:

\begin{eqnarray}
	\theta_{m}(s)=\frac{\frac{3}{2}P_{p}\lambda^{r'}_{m}}{(J_{eq}L_{q}s^{2}+(R_{s}J_{eq}+L_{q}b_{eq})s + \frac{3}{2}P_{p}^{2}\lambda ^{r'2}_{m}+R_{s}b_{eq}).s} V_{qs}(s) \nonumber\\
	- \frac{L_{s}+R_{s}}{(J_{eq}L_{q}s^{2}+(R_{s}J_{eq}+L_{q}b_{eq})s + \frac{3}{2}P_{p}^{2}\lambda ^{r'2}_{m}+R_{s}b_{eq}).s} T_{leq}(s)
	\label{eq:2.1.2.ff.3}
	\end{eqnarray}
De donde se obtienen las dos funciones de transferencia:
\begin{equation}
	G^{\theta}_{v^{r}_{qs}}(s)=\frac{\theta_{m}(s)}{V_{qs}(s)}=\frac{\frac{3}{2}P_{p}\lambda^{r'}_{m}}{(J_{eq}L_{q}s^{2}+(R_{s}J_{eq}+L_{q}b_{eq})s + \frac{3}{2}P_{p}^{2}\lambda ^{r'2}_{m}+R_{s}b_{eq}).s}
	\label{eq:2.1.2.ff.4}
	\end{equation}
	\begin{equation}
	G^{\theta}_{T_{leq}}(s)=\frac{\theta_{m}(s)}{T_{leq}(s)}=\frac{L_{q}.s+R_{s}}{(J_{eq}L_{q}s^{2}+(R_{s}J_{eq}+L_{q}b_{eq})s + \frac{3}{2}P_{p}^{2}\lambda ^{r'2}_{m}+R_{s}b_{eq}).s}
	\label{eq:2.1.2.ff.5}
	\end{equation} 


Siguiendo el mismo procedimiento se pueden obtener las funciones de transferencia desde las entradas $v^{r}_{qs}(t)$ y $T_{l}$ hacia la salida $i^{r}_{qs}$.\\
\begin{equation}
	G^{i^{r}_{qs}}_{v^{r}_{qs}}(s)=\frac{i^{r}_{qs}(s)}{V_{qs}(s)}=\frac{J_{eq}.s+b_{eq}}{J_{eq}L_{q}s^{2}+(R_{s}J_{eq}+L_{q}b_{eq})s + \frac{3}{2}P_{p}^{2}\lambda ^{r'2}_{m}+R_{s}b_{eq}}
	\label{eq:2.1.2.ff.6}
	\end{equation}
	\begin{equation}
	G^{i^{r}_{qs}}_{T_{leq}}(s)=\frac{i^{r}_{qs}}{T_{leq}(s)}=\frac{P_{p}\lambda^{r'}_{m}}{J_{eq}L_{q}s^{2}+(R_{s}J_{eq}+L_{q}b_{eq})s + \frac{3}{2}P_{p}^{2}\lambda ^{r'2}_{m}+R_{s}b_{eq}}
	\label{eq:2.1.2.ff.7}
	\end{equation} 
\end{enumerate}

\subsubsection{Análisis de Estabilidad a lazo abierto para el modelo LTI equivalente aumentado}

\begin{itemize} 
\item \textbf{Polos y ceros del sistema.}\\
Para el cálculo de los polos y ceros se tomaron $R_{s}=1.02\ \Omega $ y valores nominales de los parámetros de carga.
\subitem \textbf{Subsistema mecánico}\\
Se calculan los polos y ceros para la variable de estado $\theta_{m}$ a partir de las funciones de transferencias $G^{\theta}_{v^{r}_{qs}}$ (ec.\ref{eq:2.1.2.ff.4}) y $G^{\theta}_{T_{leq}}$ (ec. \ref{eq:2.1.2.ff.5}).
 
El sistema tiene un cero para $G^{\theta}_{T_{leq}}$ dado por :

	\begin{equation}
	Lq . s + R_{s}=0; \ s=-\frac{R_{s}}{L_{q}} = -175.86 \frac{rad}{s}
	\label{eq:2.1.2.g.1}
	\end{equation}
	
Los polos del sistema se obtienen mediante el polinomio característico (ec. \ref{eq:2.1.2.g.2} ).

	\begin{equation}
	s.[J_{eq}L_{q}s^{2}+(R_{s}J_{eq}+L_{q}b_{eq})s + \frac{3}{2}P_{p}^{2}\lambda ^{r'2}_{m}+R_{s}b_{eq}]
	\label{eq:2.1.2.g.2}
	\end{equation}
	
De donde fácilmente se obtiene:\\
$s_{1}=0\ \frac{rad}{s}$

y para calcular los otros polos utilizamos un programa de cálculo como Matlab y así obtenemos:\\
$s_{2}=-89.26 + 301.57 i\ \frac{rad}{s}$\\
$s_{3}=-89.26 - 301.57 i\ \frac{rad}{s}$

Para calcular la frecuencia natural y el coeficiente de amortiguamiento se obtuvo de la ec. \ref{eq:2.1.2.g.2} la siguiente ecuación :

	\begin{equation}
	s^{2}+\frac{(R_{s}J_{eq}+L_{q}b_{eq})}{J_{eq}L_{q}}s +\frac{\frac{ \frac{3}{2}P_{p}^{2}\lambda ^{r'2}_{m}}{J_{eq}L_{q}}+R_{s}b_{eq}}{J_{eq}L_{q}}
	\label{eq:2.1.2.g.3}
	\end{equation}
	
y se comparó esta con la ec. \ref{eq:2.1.2.g.4} que se encuentra en función de $\xi$ y $\omega_{n}$.
	\begin{equation}
	s^{2}+2\xi \omega_{n} s + \omega_{n}^2 
	\label{eq:2.1.2.g.4}
	\end{equation}

Por lo tanto se deduce que:\\
$\omega_{n}^2 =\frac{\frac{ \frac{3}{2}P_{p}^{2}\lambda ^{r'2}_{m}}{J_{eq}L_{q}}+R_{s}b_{eq}}{J_{eq}L_{q}}$ \ ; $\omega_{n}=314.5 \frac{rad}{s}$\\
$2\xi \omega_{n}=\frac{(R_{s}J_{eq}+L_{q}b_{eq})}{J_{eq}L_{q}}$ \ ; $\xi=0.2838$

Para la variable de estado $\omega_{m}$, calculando las funciones de transferencias $G^{\omega}_{v^{r}_{qs}}$y $G^{\omega}_{T_{l}}$, se realiza el mismo procedimiento y se encuentra que los ceros son los mismos y que el sistema tiene dos polos iguales a $s_{2}$ y$s_{3}$.

Se puede apreciar que ambas variables tienen una respuesta subamortiguada y que son estables, ya que, todos los polos tienen parte real negativa.\\
En la figura \ref{fig:polos} se puede observar los polos en el plano imaginario.

	\begin{figure}[h!]
	\centering
	\includegraphics[width=0.5\textwidth]{polos.png}
	\caption{\label{fig:polos}  Polos de $G^{\theta}_{v^{r}_{qs}}$ y $G^{\theta}_{T_{leq}}$}
	\end{figure}

	\vspace{0.2cm}
\subitem \textbf{Subsistema eléctrico}\vspace{0.2cm} \\
A Partir de las funciones de transferencias $G^{i^{r}_{qs}}_{v^{r}_{qs}}$ (ec.\ref{eq:2.1.2.ff.6})y $G^{i^{r}_{qs}}_{T_{leq}}$ (ec.\ref{eq:2.1.2.ff.7}) para la salida $i^{r}_{qs}$, se tiene un cero para la entrada $v^{r}_{qs}$ en $s=-2.654\ \frac{rad}{s}$ y dos polos iguales a $s_{2}$ y $s_{3}$.

Además la variable de estado $i^{r}_{ds}$ tiene un polo calculado anteriormente en $s=-154,55\ \frac{rad}{s}$, por lo que este sistema tiene una constante de tiempo $\tau=6.47 ms$, lo que demuestra la rapidez de $i^{r}_{ds}$ de la que se hacía hincapié anteriormente.

Vemos que ambas variables son estables y que $i^{r}_{qs}$ tiene una respuesta subamortiguada.

\vspace{0.2cm}
\subitem \textbf{Subsistema térmico}\vspace{0.2cm} \\
Calculando las funciones de transferencias  $G^{T_{s}}_{P_{s perd}}$ y $G^{T_{s}}_{T_{amb}}$ encontramos que el subsistema tiene un polo en $s=-0.00833\ \frac{rad}{s}$ con una constante de tiempo $\tau=120 s$, lo que nos dice que es un sistema muy lento pero estable.
\newpage
\item \textbf{Migración de propiedades.}\vspace{0.2cm}\\
Se hace necesario evaluar la estabilidad del sistema ante la variación de los parámetros de carga, ya que como sabemos el robot presenta dinámica no lineal acoplada y se considera como aproximación la dinámica de carga `vista' desde el eje de la articulación hombro, asumiendo variación de sus parámetros equivalentes. En la figura \ref{fig:varpolos} se observa como cambian los polos del sistema cuando se varían estos parámetros dentro de sus límites de incertidumbre.

	Se puede observar como el aumento de $J_{l}\ [kg\cdot m^2]$ provoca una pequeña disminución de la parte real y una mayor de la parte imaginaria del polo y se puede concluir que si los límites de incertidumbre son correctos el sistema va a permanecer estable. Por otra lado el la figura \ref{fig:varpolosbl} se puede ver la variación de estos con respecto a $b_{l}\ [\frac{N\cdot m}{rad/s}]$ y se puede concluir que la variación de este parámetro dentro de sus límites de incertidumbre prácticamente no afecta al sistema.
	
	\begin{figure}[h!]
	\centering
	\includegraphics[width=0.5\textwidth]{varpolos.png}
	\caption{\label{fig:varpolos} Migración de polos con variación de $J_{l}$.}
	\end{figure}
	
			\begin{figure}[h!]
	\centering
	\includegraphics[width=0.5\textwidth]{varpolosbl.png}
	\caption{\label{fig:varpolosbl} Migración de polos con variación de $b_{l}$.}
	\end{figure}

\end{itemize}
\subsubsection{Análisis de Observabilidad completa de estado para el modelo LTI equivalente aumentado}
Se cálculo la observabilidad del modelo LTI (ec .\ref{eq:2.1.2.e.4}) mediante el criterio de Kalman :
	\begin{equation}
	Rango \ de\  O=
	\begin{bmatrix}
	
		C\\ 
		C.A\\ 
		...\\ 
		C.A^{n-1}
		\end{bmatrix}=n
	\label{eq:2.1.2.kk.1}
	\end{equation}
	
	Donde:
	
		\begin{equation}
		A=\begin{bmatrix}
	0 & 1 &0 &0&0\\ 
	0 & -\frac{b_{eq}}{J_{eq}} & \frac{3 P_{p} \lambda^{r'}_{m}}{2 J_{eq}} & 0&0\\ 
	0  & \frac{- P_{p} \lambda^{r'}_{m}}{ L_{q}} & \frac{-R_{s}}{L_{q}} & 0&0\\
	0 & 0 & 0 & -\frac{1}{R_{ts-amb} C_{ts}}&0\\
	0&0&0&0&-\frac{R_{s}}{L_{d}}
	\end{bmatrix}
	\label{eq:2.1.2.kk.2}
	\end{equation}
	\begin{equation}
		C=[1 \ \ 0 \ \ 0 \ \ 0 \ \ 0 ] 
	\label{eq:2.1.2.k.3}
	\end{equation}

	
Según el criterio de Kalman para que el sistema sea observable el rango de la matriz $O$ tiene que ser igual a la cantidad $n$ de estados. Al calcular la observabilidad desde $\theta_{m}(t)$ mediante la ec.\ref{eq:2.1.2.kk.1}, obtenemos que el rango de esta matriz es 3, por lo que el sistema no es completamente observable, esto se debe a que $i^{r}_{ds}$ no es un estado observable desde $\theta_{m}(t)$, ya que como se puede apreciar en la ec.\ref{eq:2.1.2.e.4} este estado no tiene influencia sobre  $\theta_{m}(t)$, lo mismo ocurre para $T°_{s}$ .

Otra alternativa es medir la observabilidad desde $\omega_{m}$ en donde obtenemos que esta se degrada aún más, ya que además de $i^{r}_{ds}$ y  $T°_{s}$, $\theta_{m}(t)$ tampoco es observable desde esta. 

\subsubsection{Análisis de Controlabilidad completa de estado para el modelo LTI equivalente aumentado}
Se procedió a calcular la controlabilidad del modelo LTI (ec.\ref{eq:2.1.2.e.4}) a partir del criterio de Kalman (ec. \ref{eq:2.1.2.l.1}).

	\begin{equation}
		Rango \ de \ C=[B \ A.B \ ... \ A^{n-1}.B]= n
	\label{eq:2.1.2.l.1}
	\end{equation}
	
	Donde A es la definida en la ec.\ref{eq:2.1.2.kk.2} y B es :
	\begin{equation}
		B= \begin{bmatrix}
	0  \\ 
	0 \\ 
	 \frac{1}{L_{q}}\\
	 0\\
	 0
	\end{bmatrix}
	\label{eq:2.1.2.l.2}
	\end{equation}
	
Se concluye que el sistema no es completamente controlable desde la entrada manipulada $v^{r}_{qs}(t)$ dado que el rango de $C$ es 3, esto se debe a que los estados $i^{r}_{ds}$ y $T°_{s}$ no son controlables desde $v^{r}_{qs}(t)$.
Para controlador el estado $i^{r}_{ds}$ se debería agregar la entrada $v^{r}_{ds}(t)$.

\subsubsection{Simulación dinámica en DT, comparando el modelo NL completo desacoplado con Ley de control
NL vs LTI equivalente aumentado}
\begin{itemize}

\item \textbf{Respuesta del estado interno a pulso de consigna de tensión de estator en eje q, superpuesto con doble pulso de torque de carga.}
	
	En la figura \ref{fig:iq_LTIvsNL} se puede observar que la corriente establecida en el eje q es igual para ambos modelos, tanto cuando $i^{r}_{ds}(0)=0$ como cuando $i^{r}_{ds}(0)=\pm 0.5\ A$ esto se debe a que como puede verse en la figura \ref{fig:ids}, $i^{r}_{ds}$ decrece rápidamente a cero antes que se establezca la consigna $v^{r}_{qs}$, por lo que al estar la máquina estática esta no tiene efecto alguno sobre el sistema y por lo tanto no se produce acoplamiento de esta sobre el eje q ni tiene efecto sobre el torque, es decir, que esta corriente inicial solamente se va a disipar en el bobinado estatórico.
	Es por esto que las demás figuras únicamente se graficaron para el modelo NL, ya que presentan el mismo comportamiento para el modelo LTI para la entrada dada como consigna, independientemente de $i^{r}_{ds}(0)$.\\
			\begin{figure}[h!]
	\centering
	\includegraphics[width=0.5\textwidth]{iq_LTIvsNL.png}
	\caption{\label{fig:iq_LTIvsNL} $i^{r}_{qs}$ vs $t$.}
	\end{figure}
		

	\begin{figure}[h!]
	\centering
	\includegraphics[width=0.45\textwidth]{ids.png}
	\caption{\label{fig:ids} $i^{r}_{ds}$vs t.}
	\end{figure}
	Producto del forzamiento de $i^{r}_{ds}=0$ podemos ver que el sistema se comporta como un motor de CC, ya que la velocidad del motor depende de manera proporcional al voltaje de entrada e inversamente proporcional al torque de carga esto se puede ver claramente observando la figura \ref{fig:theta_m} y la figura \ref{fig:vd_vq}, vemos que luego de afectar con el escalón $v^{r}_{qs}$ la velocidad después de un transitorio se establece constante, lo mismo ocurre en $t=0.3\ s$ cuando se afecta al sistema con un escalón $T_{l}$ provocando una disminución de la velocidad.
	También hay que notar el excesivo sobrepico en $i^{r}_{qs}$ producto de la consigna de tensión, lo que indica que no es buena práctica afectar al sistema con este tipo de entradas, se puede también observar el aumento de la corriente por la entrada de torque, dado que el sistema necesitará mayor torque motor para contrarrestar este.\\
	
	\begin{figure}[h!]
	\centering
	\includegraphics[width=0.5\textwidth]{theta_m.png}
	\caption{\label{fig:theta_m} $\omega_{m}$ vs $t$ y $\theta_{m}$ vs $t$.}
	\end{figure}
	\begin{figure}[h!]
	\centering
	\includegraphics[width=0.5\textwidth]{vd_vq.png}
	\caption{\label{fig:vd_vq} $v^{r}_{ds}$ y $v^{r}_{qs}$.}
	\end{figure}
	Otro punto interesante a notar es la gran acción de control $v^{r}_{ds}$ que se realiza para mantener $i^{r}_{ds}=0$ durante el transitorio del sistema y como esta aumenta en magnitud cuando se da la perturbación de carga.\\
	Es importante resaltar como la temperatura (figura \ref{fig:temperatura}) aumenta cada vez que se tiene un pico grande de corriente esto se debe a que esta depende de manera cuadrática de las corrientes.\\

	\begin{figure}[h!]
	\centering
	\includegraphics[width=0.5\textwidth]{temperatura.png}
	\caption{\label{fig:temperatura} Temperatura vs t.}
	\end{figure}
	\newpage
	Como se puede ver en la figura \ref{fig:corriente} los sobrepicos en el transitorio vistos en $i^{r}_{qs}$ se corresponden con los sobrepicos en las corrientes de fases $abcs$ y luego de estos transitorios estas convergen a tres ondas sinusoidales desfasadas 120° eléctricos de igual magnitud adoptando una frecuencia tal que $\frac{f_{e}.2\pi}{P_{p}}=\omega_{mestable}$. También se puede observar que cuando $i^{r}_{qs}$ aumenta en magnitud estas también lo hacen. El mismo comportamiento se puede observar para las tensiones de fase en la figura \ref{fig:v}.



	\begin{figure}[h!]
	\centering
	\includegraphics[width=0.7\textwidth]{corriente.png}
	\caption{\label{fig:corriente} Corrientes de fase $i_{abcs}$.}
	\end{figure}
	\begin{figure}[h!]
	\centering
	\includegraphics[width=0.7\textwidth]{v.png}
	\caption{\label{fig:v} Tensiones de fase $v_{abcs}$.}
	\end{figure}
	\newpage
	Partiendo de la transformación inversa de Park y tomando $i^{r}_{ds}(t) \equiv 0$ , $i^{r}_{0s}(t)=0$ y $v^{r}_{0s}(t)=0$ podemos obtener analíticamente la forma de la tensión y corrientes $abcs$.
	
	$i_{as}(t)=i^{r}_{qs}(t)\cdot cos(\theta_{r}(t))$\\
	$i_{bs}(t)=i^{r}_{qs}(t)\cdot cos(\theta_{r}(t)-\frac{2}{3}\pi)$\\
	$i_{cs}(t)=i^{r}_{qs}(t)\cdot cos(\theta_{r}(t)+\frac{2}{3}\pi)$\\
	$v_{as}(t)=v^{r}_{qs}(t)\cdot cos(\theta_{r}(t)) + (L_q\cdot i_{ds}^{r}(t)\cdot P_p \cdot \omega_m(t))\cdot sin(\theta_{r}(t))$\\
	$v_{bs}(t)=v^{r}_{qs}(t)\cdot cos(\theta_{r}(t)-\frac{2}{3}\pi) + (L_q\cdot i_{ds}^{r}(t)\cdot P_p \cdot \omega_m(t))\cdot sin(\theta_{r}(t)-\frac{2}{3}\pi)$\\
	$v_{cs}(t)=v^{r}_{qs}(t)\cdot cos(\theta_{r}(t)+\frac{2}{3}\pi) + (L_q\cdot i_{ds}^{r}(t)\cdot P_p \cdot \omega_m(t))\cdot sin(\theta_{r}(t)+\frac{2}{3}\pi)$\\
	
	Como se puede ver las corrientes y tensiones de fase estatóricas siempre van a estar desfasadas 120° eléctricos, y para el caso planteado la amplitud de las corrientes dependerá únicamente de $i^{r}_{qs}(t)$ y la de las tensiones de $v^{r}_{qs}$ y $v^{r}_{ds}$  .\\
	En la figura \ref{fig:T vs velocidad} se presenta la curva paramétrica torque vs velocidad con la cual es posible evaluar los cuadrantes de operación del sistema. En primer lugar se debe observar como el motor parte del equilibrio estacionario (cuadrado blanco) y se desplaza hacia un punto de equilibrio dinámico (cuadro verde) producto de la consigna de tensión, en este punto el motor se encuentra en el \textbf{primer cuadrante}. En segundo lugar, debido a $T_{l}$ el punto de equilibrio dinámico se traslada al representado por el cuadrado azul, vemos ahora que el torque motor es mayor pero la velocidad menor. Después producto de la nueva consigna de torque $T_{l}$ ahora negativa, vemos que el sistema pasa a operar en el \textbf{segundo cuadrante}(cuadrado rosado), como se observa la velocidad ha aumentado y el torque motor es negativo (mayor tensión inducida que tensión de alimentación), es decir que el motor está frenando. Luego el sistema pasa a operar en el punto dado por el cuadrado violeta debido a que se le ha quitado la alimentación a este y por lo tanto aumenta el torque motor y la acción de frenado del motor hacia el torque de carga, y disminuye la velocidad. Por último al sacar la consigna de $T_{l}$ vemos como el motor comienza a volver hacia el punto de equilibrio estacionario (cuadrado blanco).
	
	\begin{figure}[h!]
		\centering
		\includegraphics[width=0.7\textwidth]{T_vs_velocidad.png}
		\caption{\label{fig:T vs velocidad} Curva paramétrica $T_{m}$ vs $\omega_{m}$.}
	\end{figure}


	\newpage
	\item \textbf{Determinación de velocidad y corriente final de establecimiento luego de cada transitorio, especificaciones en el dominio del tiempo.}
	
	En las tablas \ref{tab:1} y \ref{tab:2} se muestran los valores que caracterizan las respuestas del sistema en el dominio del tiempo.
	\begin{table}[!h]
	\begin{center}
	\begin{tabular}{| c | c | c | }
	\hline
	  & Escalón $v^{r}_{qs}=19.596 V$& Escalón $T_{l}=6.28 N.m$\\ \hline
	 $\omega_{estable} (rad/s)$ &  420.5 &  414.2 \\ \hline
	Rise Time (s) &  0.0041 &  0.0015\\ \hline
	SettlingTime (s)& 0.0437 & 0.0498 \\ \hline
	Overshoot & 39.44$\%$ & 103.15$\%$ \\ \hline
	\end{tabular}
	\caption{Valores temporales $\omega_{m}$}
	\label{tab:1}
	\end{center}
	\end{table}
	
	\begin{table}[!h]
	\begin{center}
	\begin{tabular}{| c | c | c | }
	\hline
	  & Escalón $v^{r}_{qs}=19.596 V$& Escalón $T_{l}=6.28 N.m$\\ \hline
	 $ i^{r}_{qs_{estable}}$  (A) &   0.09067 &  0.38 \\ \hline
	 Rise Time (ms) &  0.00226 &  4.1\\ \hline
	SettlingTime (s)& 0.048 & 0.0437 \\ \hline
	Overshoot & 8056.7$\%$ & 39.44$\%$ \\ \hline
	Sobre pico & 7.404 & 0.489 \\ \hline
	\end{tabular}
	\caption{Valores temporales $i^{r}_{qs}$}
	\label{tab:2}
	\end{center}
	\end{table}
	
	Como se puede apreciar ambas entradas tienen influencia sobre $ i^{r}_{qs}$ y $\omega_{m}$, sin embargo es notorio que la tensión tiene una mayor influencia sobre el valor de la velocidad al menos una vez pasados los transitorios y para $ i^{r}_{qs}$ el torque de carga tiene una mayor influencia. Esta relación se puede encontrar fácilmente aplicando el teorema del valor límite, en la ec .\ref{eq:2.1.2.i.2} se aplica a la función de transferencia de $\omega_{m}$, y se puede ver claramente que el valor de régimen permanente es proporcional con la tensión y que es inversamente proporcional con el torque de carga. Además se puede concluir también que el peso de $T_{l}$ es menor, ya que el denominador se encuentra afectado por la inversa de r.
	
	\begin{equation}
	\omega_{estable}=\frac{\frac{3}{2}P_{p}\lambda^{r'}_{m}}{\frac{3}{2}P^{2}_{p}\lambda^{r'2}_{m}+ R_{s}b_{eq}}V^{r}_{qs}(0) -  \frac{R_{s} \frac{1}{r}}{\frac{3}{2}P^{2}_{p}\lambda^{r'2}_{m}+ R_{s}b_{eq}}T_{l}(0)
	\label{eq:2.1.2.i.2}
	\end{equation}
	En la ecuación \ref{eq:2.1.2.i.3} se aplicó también este teorema a la función de transferencia de $i^{r}_{qs}$, obteniendo que el valor de ésta en régimen permanente es directamente proporcional con $v^{r}_{qs}$ y $T_{l}$, y obteniéndose como era de esperarse un mayor peso para la entrada $T_{l}$.
	\begin{equation}
	i^{r}_{qs_{estable}}=\frac{b_{eq}}{\frac{3}{2}P^{2}_{p}\lambda^{r'2}_{m}+ R_{s}b_{eq}}V^{r}_{qs}(0) +  \frac{P_{p}\lambda^{r'}_{m} \frac{1}{r}}{\frac{3}{2}P^{2}_{p}\lambda^{r'2}_{m}+ R_{s}b_{eq}}T_{l}(0)
	\label{eq:2.1.2.i.3}
	\end{equation}
	
	%\item \textbf{Comparar comportamiento de $i^{r}_{ds}(t)$ para $i^{r}_{ds}(0)=\pm  0.5 A$ vs $i^{r}_{ds}(0)=0A$ }
	\item \textbf{Field forcing and weakening a lazo abierto}
	
	Por último, se aplica una consigna de tensión en el eje d, $v^{r \ *}_{ds}(t)=\pm 1.9596 V_{cc}$ en $t=0.5 s$ para evaluar el efecto de reforzamiento y debilitamiento de campo. En las figuras \ref{fig:Tdistintode0} y \ref{fig:wdistintode0} se puede observar el efecto de este para el \textbf{modelo NL desacoplado con Ley de control NL} sobre el torque y la velocidad.\\
	Se puede observar claramente lo comentado en el inciso \textbf{2.1.2.d}, por lo que al aplicar la tensión consigna $v^{r \ *}_{ds}(t)= 1.9596 V_{cc}$ esta tiene un efecto pequeño sobre el torque pero un mayor efecto sobre $i^{r}_{qs}$. debido a que no se ha desacoplado su influencia sobre el eje q, y dado que $i^{r}_{ds}<0$ se produce un reforzamiento en el torque (lo hace más negativo, es decir, que se tiene el efecto buscado), por otro lado si la consigna de tensión es  $v^{r \ *}_{ds}(t)= -1.9596 V_{cc}$ se produce un cambio en el cuadrante de operación, ya que se pasa a operar en el primer cuadrante, osea que en vez de frenar se motoriza, teniendo ahora un torque positivo, y esto se debe a la migración del punto de operación de $i^{r}_{qs}$ (pasa de ser negativa a positivo) debido al acoplamiento con la corriente $i^{r}_{ds}$ (ec. \ref{eq:2.1.2.e.5}).
	
	\begin{figure}[h!]
	\centering
	\includegraphics[width=0.65\textwidth]{Tdistintode0.png}
	\caption{\label{fig:Tdistintode0} Field forcing and weakening $T_{m}$. \textbf{Modelo NL desacoplado con Ley de control NL }.}
	\end{figure}
	
	En la figura \ref{fig:Tdistintode0LTI} se puede ver lo que ocurre para el \textbf{modelo LTI equivalente aumentado}, vemos que aquí el efecto de $i^{r}_{ds}\neq 0$ es mucho menor, esto se debe a que en este modelo se desacopla la influencia de $i^{r}_{ds}$ sobre el eje q y por lo tanto solo influye en el sistema por el siguiente término: $(L_{d}-L_{q}).i^{r}_{ds}(t).i^{r}_{qs}(t)$ y no influye directamente sobre el punto de operación de $i^{r}_{qs}$, y dado que por las características constructivas del motor $L_{d}$ y $L_{q}$ son muy parecidas, la influencia de este término es significativamente menor en comparación a la de los demás.\\
	La diferencia de comportamiento entre ambos modelos se da entonces por el acoplamiento NL en el eje q, donde vemos que el reforzamiento y debilitamiento de campo tiene mayor influencia en el modelo NL por este acoplamiento que produce que $i^{r}_{ds}$ refuerce o debilite también $i^{r}_{qs}$ lo que hace que tenga mayor influencia sobre el torque.\\
	
		\begin{figure}[h!]
	\centering
	\includegraphics[width=0.65\textwidth]{wdistintode0.png}
	\caption{\label{fig:wdistintode0} Field forcing and weakening $\omega_{m}$.\textbf{ Modelo NL desacoplado con Ley de control NL .}}
	\end{figure}
	\begin{figure}[h!]
	\centering
	\includegraphics[width=0.65\textwidth]{Tdistintode0LTI.png}
	\caption{\label{fig:Tdistintode0LTI} Field forcing and weakening $T_{m}$.\textbf{ Modelo LTI equivalente aumentado.}}
	\end{figure}
\end{itemize}
\newpage
\subsection{Diseño, Análisis y Simulación con CONTROLADOR de Movimiento en Cascada con Modulador de Torque equivalente (Control Vectorial)}
\subsubsection{Modulador de Torque equivalente}
\begin{itemize}
\item \textbf{Desacoplamiento de todas las realimentaciones físicas naturales de estado hacia la entrada}\\
	En la figura \ref{fig:Tmodulador} se puede observar el desacoplamiento de todas las realimentaciones.
	Se ha remarcado en \textbf{rojo} la \textbf{La ley de control mínima} que anteriormente se implementó en el \textbf{modelo NL desacoplado con ley de control NL} y en \textbf{naranja} la \textbf{Ley de control complementaria mínima en el eje q}  que se implementó en el \textbf{modelo LTI equivalente aumentado}, es decir que podría decirse que los modelos realizados anteriormente son un caso particular de realizar el desacoplamiento de todas las realimentaciones de estado.
	En \textbf{gris} se nuestra el desacople de las caídas óhmicas, en verde la caída por tensión inducida producto de $\lambda^{`r}_{m}$ y en \textbf{celeste} se ha desacoplado la caída de torque por fricción.

	\begin{figure}[h!]
	\centering
	\includegraphics[width=\textwidth]{modulador de torque.png}
	\caption{\label{fig:Tmodulador}Modulador de Torque equivalente. Desacoplamiento de todas las realimentaciones físicas naturales.}
	\end{figure}
	
	En la figura \ref{fig:Ts} podemos ver el efecto de la temperatura sobre la resistencia $R_{s}$. Si la temperatura tiene variaciones importantes, como vemos la resistencia no, por lo que se podría considerar constante sin caer en grandes errores. 
	
	\begin{figure}[h!]
	\centering
	\includegraphics[width=0.45\textwidth]{Ts.png}
	\caption{\label{fig:Ts}Variación de $R_{s}$ con $T°_{s}$.}
	\end{figure}

\item \textbf{Diseño de lazos de control de corrientes $i^{r}_{qd0s}$}\\
Se realizará el desarrollo matemático del lazo de corriente. Considerando que el modulador de tensión es lo suficientemente rápido, exacto y su ganancia es unitaria (ec. \ref{eq:2.1.2.k.1}):
	\begin{equation}
	v^{*}_{qs}(t)\simeq v_{qs}(t)
	\label{eq:2.1.2.k.1}
	\end{equation}
y teniendo en cuenta los desacoples realizados en el punto anterior:
	\begin{equation}
	v^{*}_{qs}(t)= v^{*'}_{qs}(t) + R_{s}. i_{qs}(t) + [\lambda^{r'}_{m}+L_{d}.i^{r}_{ds}(t)].\omega_{m}(t)
	\label{eq:2.1.2.k.2}
	\end{equation}
Reemplazando la ec. \ref{eq:2.1.2.k.1} y ec. \ref{eq:2.1.2.k.2} en ec.\ref{sist:electrico1} obtenemos:
\begin{equation}
	\frac{di^{r}_{qs}(t)}{dt} . L_{q}= v^{*'}_{qs}(t)
	\label{eq:2.1.2.k.3}
	\end{equation}
	Donde la consigna $v^{*'}_{qs}(t)$ se define proporcional al error de corriente y con una ganancia proporcional. Por tanto el lazo de corriente para $i^{r}_{qs}(t)$ se define como:
	\begin{equation}
	\frac{di^{r}_{qs}(t)}{dt} . L_{q}= v^{*'}_{qs}(t)=(i^{r*}_{qs}(t)-i^{r}_{qs}(t)).R_{q}
	\label{eq:2.1.2.k.4}
	\end{equation}
	
	y su función de transferencia es:
		\begin{equation}
	\frac{I^{r}_{qs}(s)}{I^{r*}_{qs}(s)}=\frac{1}{s\frac{L_{q}}{R_{q}}+1}
	\label{eq:2.1.2.k.5}
	\end{equation}
	
	Podemos observar que la ec.\ref{eq:2.1.2.k.5} presenta un polo en $s=-\frac{R_{q}}{L_{q}}$. Por ende, definiendo el parámetro $R_{q}$ podemos ubicar el polo en $s=-5000[rad/s]$, así:\\
	$R_{q}=5000 . L_{q}=29\Omega$
	
	De las misma forma se determinan las ganancias para los otros lazos de corrientes, obteniendo:\\
	$R_{d}=5000 . L_{d}=33\Omega$\\
	$R_{0}=5000 . L_{ls}=4\Omega$\\
	Si comparamos con la dinámica de los modelos analizados en la \textbf{sección 2.1.6} veremos que las respuestas de las corrientes $i^{r}_{qd0s}$ son muchos más rápidas y sin oscilaciones, ya que, esto es lo que se quiso cuando se eligió el polo para estos lazos. Asi, si se tiene un $i^{r}_{ds}(0)\neq 0$ veremos que el decaimiento de esta es mucho más rápida, también la respuesta ante una entrada consigna para $i^{r}_{qs}$, donde en la tabla \ref{tab:3} se puede observar que sus características temporales son muchos mejores que las calculadas en la tabla \ref{tab:2}.
		\begin{table}[!h]
	\begin{center}
	\begin{tabular}{| c | c | c | }
	\hline
	  & Escalón $i^{r*}_{qs}$\\ \hline
	 $ i^{r}_{qs}$ Establecimiento (A) &   0.09067 \\ \hline
	 Rise Time (ms) &  0.439\\ \hline
	SettlingTime (ms)& 0.78\\ \hline
	Overshoot &0$\%$ \\ \hline
	\end{tabular}
	\caption{Valores temporales $i^{r}_{qs}$}
	\label{tab:3}
	\end{center}
	\end{table}
	
\item \textbf{Incorporación adecuada de consigna de torque}\\
Si idealizamos el problema y consideramos que los parámetros físicos modelados son iguales a los parámetros físicos reales y tenemos en cuenta el desacoplamiento y los lazos de corrientes calculados anteriormente, obtenemos control directo sobre las corrientes, lo que nos permitirá realizar el control vectorial del campo imponiendo consignas de corriente en directo nulas (o también realizar un reforzamiento o debilitamiento del campo principal) e imponer una consigna de corriente en cuadratura $i^{r}_{qs}(t)$, o  lo que es lo mismo una consigna de torque motor $T^{*'}_{m}$ multiplicado por la constante de escala $1/K_{T}$ (ec.\ref{eq:2.1.2.k.6}).
		\begin{equation}
	K_{T}=\frac{3}{2}P_{p}\lambda^{r}_{m}
	\label{eq:2.1.2.k.6}
	\end{equation}
	También hay que observar que en nuestro modulador de Torque (figura \ref{fig:Tmodulador}) se desacopla el torque generado por la fricción viscosa del motor y la caja (en celeste). Así:
			\begin{equation}
	i^{r*}_{qs}(t)=\frac{1}{K_{T}}[T^{*'}_{m}+b_{m}\omega_{m}(t)]=\frac{1}{K_{T}}T^{*}_{m}
	\label{eq:2.1.2.k.7}
	\end{equation}
	
	En la figura \ref{fig:TTmodulador_id} se dio una consigna de $T_{m}=0.0063$ a $t=0.1$ hasta $t=0.7$ y un $T_{l}$ igual al que se propuso en la sección \textbf{2.1.6}, se puede observar el aumento del torque motor al hacer el reforzamiento de campo con $i^{r}_{ds}(t)=1 A$ y en la figura \ref{fig:vqmodulador_id} se puede notar el cambio en la tensión en el eje q producto de esta corriente.
	Se puede concluir que este reforzamiento no produce mejoras significativas sobre el torque motor a comparación con el considerable aumento que se genera en la tensión del eje q, por ende tal vez no sea la mejor estrategia si se quiere un mayor torque, pero si lo que se busca es disminuir las tensiones, puede ser una buena opción realizar un debilitamiento de campo, ya que como vemos se disminuye muy poco el torque pero mucho la tensión en el eje q.
	Esta variación en la tensión del eje q con $i^{r}_{ds}(t)$  se debe a la \textbf{Ley de control mínima complementaria} (ec.\ref{eq:2.1.2.e.5}).
	
	Por otro lado, hay que notar que el sistema a comparación con la sección \textbf{2.1.6} no presenta oscilaciones en los transitorios y que el rechazo al torque de carga es prácticamente nulo, ya que si hubiese rechazó el torque total debería ser igual al consigna. 
	 	\begin{figure}[h!]
	\centering
	\includegraphics[width=0.5\textwidth]{TTmodulador_id.png}
	\caption{\label{fig:TTmodulador_id}Torque total $T_{T}=T^{*'}_{m}-\frac{T_{l}}{r}$ para $i^{r}_{ds}\neq0$ sin desacoplamiento de la influencia de $i^{r}_{ds}$ sobre el torque.}
	\end{figure}
		 	\begin{figure}[h!]
	\centering
	\includegraphics[width=0.5\textwidth]{Tmodulador_id.png}
	\caption{\label{fig:vqmodulador_id}$v^{r}_{qs}$ requerida para una $i^{r}_{ds}\neq0$ sin desacoplamiento de la influencia de $i^{r}_{ds}$ sobre el torque .}
	\end{figure}
\end{itemize}

Dado que el efecto de $i^{r}_{ds}$ sobre el torque no es significativo se desacopla (amarillo (fig. \ref{fig:Tmodulador})), por ende la consigna de $i^{r}_{ds}$ va a tener efecto solamente sobre $v^{r}_{q}$. Así:
			\begin{equation}
	i^{r*}_{qs}(t)=\frac{1}{K_{T}}[T^{*'}_{m}+b_{m}\omega_{m}(t)-K_{T_{d}}\cdot i^{r}_{ds}\cdot i^{r}_{qs}]=\frac{1}{K_{T}}T^{*}_{m}
	\label{eq:2.1.2.k.8}
	\end{equation}
	Donde:
				\begin{equation}
	K_{T_{d}}=\frac{3}{2}P_{p}\cdot (L_{d}-L_{q})
	\label{eq:2.1.2.k.9}
	\end{equation}
	
	Como se ve en la figura \ref{fig:TTmodulador_id2}, ahora $i^{r}_{ds}$ no tiene prácticamente efecto sobre el torque, aunque debido a que el lazo de corriente tiene acción proporcional únicamente el desacoplamiento no es exacto. Sin embargo, si tiene efecto sobre $v^{r}_{q}$, figura.\ref{fig:vqmodulador_id2}, muy parecido al mostrado en la figura \ref{fig:vqmodulador_id}.
		 	\begin{figure}[h!]
	\centering
	\includegraphics[width=0.55\textwidth]{TTmodulador_id2.png}
	\caption{\label{fig:TTmodulador_id2}Torque total $T_{T}=T^{*'}_{m}-\frac{T_{l}}{r}$ para $i^{r}_{ds}\neq0$ con desacoplamiento de la influencia de $i^{r}_{ds}$ sobre el torque. }
	\end{figure}
			 	\begin{figure}[h!]
	\centering
	\includegraphics[width=0.55\textwidth]{Tmodulador_id2.png}
	\caption{\label{fig:vqmodulador_id2}$v^{r}_{qs}$ requerida para una $i^{r}_{ds}\neq0$ con desacoplamiento de la influencia de $i^{r}_{ds}$ sobre el torque }
	\end{figure}
	
\subsubsection{Controlador externo de movimientos: posición/velocidad }
A continuación se diseñará el controlador (``PID'') en cascada con el modulador de torque utilizando el método de sintonía serie, con $n=2.5$ y $\omega_{pos}=800\frac{rad}{s}$.
Para obtener la ecuación de transferencia del sistema con el controlador de movimiento partiremos del modulador de torque obtenido en el inciso anterior, lo que nos permite tener un acceso directo a manipular el torque motor.
Considerando esto, la ecuación del sistema es:
		\begin{equation}
	J_{eq}\theta(s)s^{2}+b_{eq}\theta(s)s=T^{`}_{m}(s)-T_{leq}(s) \ ; \ T_{leq}= \frac{T_{l}}{r}
	\label{eq:2.1.2.q.1}
	\end{equation}
	
La ecuación del controlador PID es:
		\begin{equation}
	T^{*`}_{m}(s)=[ba+\frac{1}{s}Ksa + \frac{1}{s^{2}}Ksia]\cdot e_{w}(s)
	\label{eq:2.1.2.q.2}
	\end{equation}
	
Recordando la ec.\ref{eq:2.1.2.k.7} y la ec. \ref{eq:2.1.2.k.5} se obtiene:

	\begin{equation}
	T^{`}_{m}(s)=\frac{1}{\frac{L_{q}}{R_{q}}s+1}[T^{*'}_{m}(s)+b_{m}\omega_{m}(t)] \ ; \ G_{I}(s)=\frac{1}{\frac{L_{q}}{R_{q}}s+1}
	\label{eq:2.1.2.q.4}
	\end{equation}

	\begin{equation}
	J_{eq}\theta(s)s^{2}+b_{eq}\theta(s)s-G_{I}(s).b_{m}\theta(s)s=G_{I}(s)e_{w}(s)[ba+\frac{1}{s}Ksa + \frac{1}{s^{2}}Ksia]-T_{leq}(s)
	\label{eq:2.1.2.q.5}
	\end{equation}
	
Así, mediante estas ecuaciones obtenemos las ecuaciones de transferencias:
 
	\begin{equation}
	G_{\theta^{*}_{m}}(s)=\frac{G_{I}(s)[s^{2}ba+sKsa+Ksia]}{J_{eq}s^{3}+[b_{eq}-G_{I}(s).b_{m}]s^{2}+G_{I}(s)[s^{2}ba+sKsa+Ksia]}
	\label{eq:2.1.2.q.6}
	\end{equation}
 	\begin{equation}
	G_{T_{leq}}(s)=\frac{s}{J_{eq}s^{3}+[b_{eq}-G_{I}(s).b_{m}]s^{2}+G_{I}(s)[s^{2}ba+sKsa+Ksia]}
	\label{eq:2.1.2.q.6}
	\end{equation}
	
	Si consideramos que el lazo de corriente es lo suficientemente rápido ($G_{I}\equiv 1$), entonces los polos del sistema se determinan por el siguiente polinomio característico:
	\begin{equation}
	P_{c}=J_{eq}s^{3}+[b_{leq}+ba]s^{2}+sKsa+Ksia; \ b_{leq}= \frac{b_{l}}{r^{2}} 
	\label{eq:2.1.2.q.7}
	\end{equation}
	
	Haciendo uso del método de sintonía serie:\\
	$ n\omega_{pos}=\frac{ba+b_{leq}}{J_{eq}} \ ; \ ba=n\omega_{pos}J_{eq}-b_{leq}$ \\
	$ n\omega^{2}_{pos}=\frac{Ksa}{J_{eq}} \ ; \  Ksa=n\omega^{2}_{pos}J_{eq} $\\
	$ \omega^{3}_{pos}=\frac{Ksia}{J_{eq}} \ ; \  Ksia=\omega^{3}_{pos}J_{eq} $\\
	
	Si consideramos los valores nominales de $J_{l}$ y $b_{l}$ se tiene:\\
	$ba=0.0113 \frac{N.m}{\frac{rad}{s}}$\\
	$Ksa=9.04 \frac{N.m}{rad}$\\
	$Ksia=2892.8 \frac{N.m}{rad.s}$\\
	
	Se busca así tener un controlador PID que no haga uso de bloques derivativos, para no tener una amplificación de ruido. Por esto, en el caso de definir un perfil de posición $q^{*}(t)$, será necesario derivar el perfil.
	
	En la figura \ref{fig:controladorPID} se observa el diagrama en bloques del controlador PID.
		 	\begin{figure}[h!]
	\centering
	\includegraphics[width=0.5\textwidth]{controladorPID.png}
	\caption{\label{fig:controladorPID}Controlador PID.}
	\end{figure}
	\newpage
	La ubicación en el plano complejo de los polos del controlador, el regulador de corriente y los polos de la planta original se muestran en la figura \ref{fig:Polosmodelos}, donde se puede ver que el lazo de corriente es mucho más rápido que los demás y que los polos del controlador son más rápidos que los de la planta original.
	
	\begin{figure}[!h]
	\centering
	\includegraphics[width=0.55\textwidth]{Polosmodelos.png}
	\caption{\label{fig:Polosmodelos}Polos de la planta, lazo de corriente y controlador PID.}
	\end{figure}
	
	Dado que los polos en la figura \ref{fig:Polosmodelos} fueron graficados para valores nominales de $J_{l}$ y $B_{l}$ y que estos valores nominales pueden variar dentro de los límites especificados por la aplicación, se realizó un análisis de la migración de los polos del controlador con la variación de estos parámetros.
	La variación de $B_{l}$ no tuvo prácticamente repercusión sobre los polos del sistema.
	Pero la variación de $J_{l}$, sí produjo cambios considerables sobre los polos de este (figura \ref{fig:PoloJeq}), es por esto que se puede concluir, que el controlador, si bien es estable para todo valor considerado de los parámetros, la inercia presenta una gran influencia sobre la estabilidad de este, por lo que no se descarta que en caso de poseer mayores variaciones sea necesario recurrir a estrategias de control que se adapten en función de la inercia variable del sistema.
	\begin{figure}[h!]
	\centering
	\includegraphics[width=0.55\textwidth]{PoloJeq.png}
	\caption{\label{fig:PoloJeq}Variación de los polos del controlador con $J_{l}$.}
	\end{figure}
	
\subsubsection{Incorporación y diseño de Observador de Estado de orden reducido sólo para la parte mecánica de este controlador}

Una técnica muy utilizada para estimar una variable de estado, que no puede ser sensada y digitalizada, es implementar un observador dentro del controlador. El mismo tiene un modelo aproximado de la planta mediante el cual estima las variables de estado internas de un sistema dinámico que no son accesibles físicamente.
\par
Para nuestro sistema, solo disponemos de sensores de corriente de fase, un sensor de temperatura del bobinado estator y un sensor de desplazamiento angular para el eje del rotor del motor (encoder).
Por lo tanto, si consideramos al sistema simplificado con consigna $i_{ds}(t) = 0$ que nos lleva a un sistema equivalente al de una máquina de CC lineal con sus tres variables de estado, $\theta_m(t)$, $\omega_m(t)$, $i_{qs}(t)$, llegamos a que la velocidad angular del rotor no es accesible directamente a través de un sensor (como un tacómetro).
\par
Entonces se implementará un observador, para estimar la velocidad angular del rotor y así implementar el control final del motor.
Observaremos el subsistema mecánico, con su realimentación física por efectos viscosos, desacoplado.
Es decir, la planta estará dada por las siguientes ecuaciones:
\begin{equation}
	J_{eq}\cdot \dot{\omega_m}(t) = T_m(t) − T_{eq}(t)
\end{equation}
\begin{equation}
	\frac{\mathrm{d} \theta_m(t)}{\mathrm{d} t}=\omega_m(t)
\end{equation}

Matricialmente la planta se puede representar como:
\begin{equation}
	S_{LTI}:
	\begin{cases}
		\dot{\textbf{x}}(t) = 
		\begin{bmatrix}
		0 & 1 \\ 
		0 & 0
		\end{bmatrix} \textbf{x}(t) + 
		\begin{bmatrix}
			0  \\ 
			\frac{1}{J_{eq}} 
		\end{bmatrix}
		u(t) + 
		\begin{bmatrix}
			0  \\ 
			-\frac{1}{J_{eq}} 
		\end{bmatrix}
		d(t)
		\\
		y(t)= \textbf{C}\cdot \textbf{x}(t)
	\end{cases}
\end{equation}

Donde:
\begin{equation}
	\textbf{x}(t)=
	\begin{bmatrix}
		\theta_m(t) \\ 
		\omega_m(t) 
	\end{bmatrix}
	\ \ ;\ \ u(t)=T_{m}^{'}(t)\ \ ;\ \ d(t)=T_{eq}(t)\ \ ;\ \ \textbf{C}=
	\begin{bmatrix}
		1 & 0
	\end{bmatrix}
\end{equation}

El observador entonces, viene dado por la siguiente ecuación:
\begin{equation}
	Observador :
	\begin{cases}
		\dot{\tilde{\textbf{x}}}(t)=\tilde{A}\cdot \tilde{\textbf{x}}(t)+\tilde{B}\cdot u(t)+\textbf{K}_\textbf{e}\left(y(t)-\tilde{y}(t)\right)\ \ ;\ \ \dot{\tilde{\textbf{x}}}(t_0)=0
		\\
		\tilde{y}(t)=\textbf{C}\cdot\tilde{\textbf{x}}(t)
	\end{cases}
\end{equation}

Donde:
\begin{equation}
	\tilde{\textbf{x}}(t)=
	\begin{bmatrix}
		\tilde{\theta}_m(t)\\
		\tilde{\omega}_m(t)
	\end{bmatrix}
	\ \ ;\ \ u(t)=T_{m}^{'}(t)\ \ ;\ \ \textbf{K}_\textbf{e}=
	\begin{bmatrix}
		K_{oth}\\
		K_{ow}
	\end{bmatrix}
\end{equation}

Donde en el mejor caso $\tilde{\textbf{A}} \equiv \textbf{A}$ y $\tilde{\textbf{B}} \equiv \textbf{B}$; $y(t)$ corresponde a la variable de estado tomada de la planta física real.
En nuestro caso la variable medida es $\theta_m(t)$ y la salida del observador será $\tilde{\theta}_m(t)$.
Reordenando, definimos al modelo del Observador Asintótico según la ecuación:
\begin{equation}
	O_{Asintótico}:
	\begin{cases}
		\dot{\tilde{\textbf{x}}}(t)=\left[
			\begin{bmatrix}
				0 & 1\\
				0 & 0
			\end{bmatrix}
			-\textbf{K}_{\textbf{e}}\cdot \textbf{C}
		\right]
		\tilde{\textbf{x}}(t)+
		\begin{bmatrix}
			0\\
			\frac{1}{J_{eq}}
		\end{bmatrix}
		u(t)+\textbf{K}_{\textbf{e}}\cdot y(t)
		\\
		y(t)=\textbf{C}\cdot \textbf{x}(t)
	\end{cases}
\end{equation}

Luego de verificar la observabilidad del sistema con salida $\theta_m(t)$, vamos a pasar al siguiente paso que es la ubicación de polos del observador en el plano s.
El polinomio característico se obtiene de calcular el determinante:
\begin{equation}
	det(sI-[\tilde{A}-K_e\cdot C])
\end{equation}

Por lo que la posición de los polos es dependiente de $K_{oth}$ y $K_{ow}$.
Si se quieren ubicar dos polos reales e iguales en $p_{obs1,2}=-3200\frac{rad}{s}$.
Hay que igualar el polinomio:
\begin{equation}
	det\left( 
		\begin{bmatrix}
			s+K_{oth} & -1 \\
			K_{ow} & s
		\end{bmatrix}
	 \right)=s^2+s\cdot K_{oth}+K_{ow}
\end{equation}
con el polinomio deseado que tiene la forma:
\begin{equation}
	(s+3200)^2=s^2+6400s+3200^2
\end{equation}

De donde obtenemos que:
\begin{equation}
	\begin{matrix}
		K_{oth}=6400 \left[\frac{1}{s}\right]\\
		\\
		K_{ow} =3200^2 \left[\frac{1}{s^2}\right]
	\end{matrix}
\end{equation}

En diagramas de bloques, podemos representar el observador como se ve en la figura:
\begin{figure}[h!]
	\centering
	\includegraphics[width=0.9\textwidth]{diagramaObservador.png}
	\caption{\label{fig:consigna2}Diagramas en bloques del observador}
\end{figure}


\subsubsection{Simulación en tiempo continuo con modelo completo NL}
\begin{itemize}
	\item \textbf{Seguimiento de consignas}

Para la simulación del sistema se utilizará un perfil trapezoidal de posición 
$\theta_{l}=q1^{*}(t) \equiv \frac{1}{r}\theta^{*}_{m}(t)$ con $q_{1}^{*}(t)=0 \rightarrow (\Delta t_{ramp}=5s) \rightarrow 2.\pi [rad] \rightarrow (\Delta t_{ramp}=5s) \rightarrow 0$. Como vemos se plantea un giro completo de la articualción del robot en 5s
con una velocidad constante y luego la vuelta de la misma a la posición cero.
 \begin{figure}[h!]
	\centering
	\includegraphics[width=0.75\textwidth]{consigna.png}
	\caption{\label{fig:consigna}Posición angular sensada, observada y consigna.}
	\end{figure}

En la figura \ref{fig:consigna} se puede observar el seguimiento de la consigna dada y en la figura \ref{fig:consigna2} se muestra la velocidad angular.
Como vemos las consignas se siguen correctamente.
\begin{figure}[h!]
		\centering
		\includegraphics[width=0.7\textwidth]{consigna2.png}
		\caption{\label{fig:consigna2}Velocidad angular teórica, observada y consigna.}
		\end{figure}

Pero se puede observar que hay sobrepicos en ambas figuras, esto se debe a que la señal de consigna elegida no es la mejor, ya que como se ve, en los quiebres bruscos de posición se producen escalones de velocidad, lo que a su vez generan impulsos muy grandes de aceleración y esto es lo que produce el gran overshoot, visto sobre todo en la velocidad.

	\item \textbf{Rechazo a perturbaciones}
	
	Se analizará la respuesta del sistema ante cargas externas, considerando valores nominales y variación máxima de los parámetros de carga mecánica física.
	Para observar más fácilmente los efectos de las perturbaciones se da una consigna de posición nula y se perturba al sistema con $T_{l}=6.28 N.m$.
	
	En la figura \ref{fig:perturbaciones} se puede ver que el sistema presenta un error estacionario ante una perturbación y también que este varía al cambiar los parámetros de carga, en este caso $J_{l}$, vemos además que la mayor variación se da en el transitorio. Por otro lado, al variar $b_{l}$ no se notaron cambios por lo que no se graficó. Sin embargo, se puede apreciar que el rechazo a las perturbaciones es prácticamente igual 
	por lo que el sistema es robusto ante el cambio de estos parámetros dentro de los límites considerados.
	Y el error se da a causa de haber implementado un observador PD, el mismo no es capaz de rechazar las perturbaciones del sistema.
	\begin{figure}[h!]
		\centering
		\includegraphics[width=0.7\textwidth]{perturbaciones.png}
		\caption{\label{fig:perturbaciones}Posición angular sensada, observada y consigna.}
		\end{figure}
	\end{itemize}
	\newpage
\subsubsection{Verificación de desempeño y/o mejoras}
\begin{itemize}
	\item \textbf{Verificar si se supera/n alguna/s de las Especificaciones de operación}\\
	En la siguiente tabla (\ref{tab:4}) se visualizará los valores alcanzados por las variables del sistema y sus límites. En la figura \ref{fig:parametros} se muestran distintas variables internas de la planta.
	\begin{table}[h!]
		\begin{center}
		\begin{tabular}{| c | c | c | }
		\hline
		  & Valores medidos & Valor nominal  \\ \hline
		 Tensión de fase (V) & 1889 (Pico), 18.4 (R. continuo) & 19.5959\\ \hline
		 Vel. rotor [rad/s]& 556.2 (Pico) 395 (R. continuo)&  691.15\\ \hline
		Corriente (R. continuo) (A) &0.085 & 0.5656\\ \hline
		Corriente (corta duración) (A) &52.82 &2.8284\\ \hline
		Temperatura (°C) &54.1 & 115\\ \hline
		Torque corta duración (N.m) & 1425 & 29.42\\ \hline
		Torque R. continuo (N.m) & 0 & 7.26\\ \hline
		\end{tabular}
		\caption{Variables del sistema}
		\label{tab:4}
		\end{center}
		\end{table}



Como se muestra en la tabla \ref{tab:4}, el sistema para la consigna planteada supera ampliamente los límites establecidos, por lo que es necesario remendar esta situación, ya que si se opera en estas condiciones, se dañaría gravemente al sistema.
Se puede concluir que la causa de esto es la consigna de posición sugerida, ya que está, sobre exige al sistema provocando que este opere fuera de sus límites.

 De esta manera se procedió a cambiar la forma de esta consigna, eligiendo un perfil trapezoidal de aceleración para el cual vamos a tener en cuenta las siguientes restricciones:

\begin{itemize}
	 \item Restricción de velocidad: Como ya se mencionó anteriormente la velocidad es directamente proporcional a la tensión por lo que en el caso de nuestro motor, la velocidad
	 va a estar limitada por la tensión pico máxima de fase admisible, \textbf{$V_{sfnom}=19.5656 V$}, la cual a partir de la ec.\ref{eq:2.1.2.i.2} nos permite calcular nuestra velocidad
	 máxima, siendo esta $\omega_{m}=419.86\frac{rad}{s}$, de esta manera esta queda limitada por el subsistema electrico y no por la parte mecánica, ya que, el tren de transmisión nos 
	 permite una $\omega_{m}=691.15\frac{rad}{s}$.

	 \item Restricción de aceleración: El torque motor es proporcional a la corriente y a su vez es proporcional a la aceleración, por ende la aceleración del perfil consigna elegido
	 va a estar limitada por las corrientes nominales y picos establecidos por el fabricante.

	 \item Restricción de Jerk: Si bien en las especificaciones de nuestra aplicación no se limita este, es un parámetro muy importante a tener en cuenta ya que es lo que determina las sacudidas 
	 que se producen sobre el sistema y es la resistencia mecánica de la articulación la que determina su valor máximo permitido. Además como se podrá apreciar un perfil trapezoidal de velocidad
	 produce sobrepicos en la aceleración, por lo que si se quiere minimizar este efecto, este perfil no es el mejor. Es por esto que se propuso un perfil trapezoidal de aceleración imponiendo un jerk máximo igual a $20 \frac{rad}{s^{3}}$.
\begin{figure}[h!]
	\centering
	\includegraphics[width=0.7\textwidth]{parametros.png}
	\caption{\label{fig:parametros}Torque motor consigna referido al eje de salida de la transmisión $(T^{*'}_{q}=T^{*'}_{m}.r)$, corriente, tensión y temperatura.}
	\end{figure}
 \end{itemize}

 Teniendo en cuenta las restricciones anteriormente planteadas, y que la velocidad mínima para realizar la consigna demandada es $\omega_{m}=395[\frac{rad}{s}]$ (perfil trapezoidal en posición), concluimos que esta consigna no es alcanzable
 por nuestro sistema, por lo cual se propone hacer un debilitamiento
 de campo con $i^{r}_{ds}=-0.4A$, lo que provoca que nuestro límite de velocidad pase a ser $\omega_{m_{max}}=488[\frac{rad}{s}]$, por lo tanto el perfil de velocidad lo vamos a restringir para una velocidad máxima $\omega_{m}=455[\frac{rad}{s}]\rightarrow \omega_{l}=1.45[\frac{rad}{s}]$ y 
 $\Delta t_{ramp}=5s$ por lo que nuestro perfil queda como se ve en la figura \ref{fig:consignasnuevas}. Como se ve el jerk es menor al límite impuesto.
 
 \begin{figure}[h!]
	\centering
	\includegraphics[width=0.7\textwidth]{consignasnuevas.png}
	\caption{\label{fig:consignasnuevas}Perfil de posición, velocidad y aceleración}
	\end{figure}

	En la figura \ref{fig:consignanuevapara} se muestran las variables del sistema ante la nueva consigna establecida.

	\begin{figure}[h!]
		\centering
		\includegraphics[width=0.7\textwidth]{consignanuevapara.png}
		\caption{\label{fig:consignanuevapara}Torque motor consigna referido al eje de salida de la transmisión $(T^{*'}_{q}=T^{*'}_{m}.r)$, corrientes, tensiones y temperatura}
		\end{figure}
	\begin{figure}[h!]
	\centering
	\includegraphics[width=0.7\textwidth]{corten.png}
	\caption{\label{fig:corten}Corrientes y tensiones en bornes $abcs$.}
	\end{figure}
	Las consignas de velocidad y posición son seguidas a la perfección por el motor y como se puede observa en las figuras \ref{fig:consignanuevapara} y \ref{fig:corten} todas las variables estan dentro de los limites establecidos. Es bueno notar que la corrientes $i_{abcs}$ ahora no dependen únicamente de $i^{r}_{qs}$, si no, que también de $i^{r}_{ds}$ como se puede ver en la figura \ref{fig:corten}.
	 
	Una desventaja importante del debilitamiento de campo es que se tiene una corriente $i^{r}_{ds}$ distanta de cero constante, lo que provoca que la temperatura del motor suba mas rápidamente a comparación cuando esta es nula que la temperatura prácticamente no varía.
	\newpage
	\item \textbf{Observador agregado}\\
	Como ya se analizó anteriormente el observador presenta error de estado estacionario ante perturbaciones de carga dado que es un observador PD. 
	Estos no son capaces de observar las perturbaciones externas de la planta observable. Si se analiza la dinámica del error de observación:
	\begin{eqnarray}
		\dot{e}(t)=[A-K_{e}C]e(t)+B_{d}d(t); \ e(t_{0})=x_{0}  \ \ \
		e(t)=x(t)-\tilde{x}(t)
		\label{eq:2.1.2.x.1}
	\end{eqnarray}
	Si los polos del observador se encuentran lo suficientemente lejos del origen para hacer al observador estable y rápido, $e(t)$ tenderá a ser nulo si el término $d(t)$ es nulo, es decir si no existen perturbaciones.
	Este error permanente se debe a la falta de la acción integral, por tanto a continuación se determinarán los nuevos parámetros del observador con polos ubicados en $p_{1,2,3}=-3200 \frac{rad}{s}$, siendo las nuevas ecuaciones del observador las siguientes:
	\begin{equation}
		\left\{\begin{matrix}
			\frac{d\tilde{\theta}_{m}(t)}{dt}=\tilde{\omega}_{m}(t)+K_{\theta}(\theta_{m}(t)-\tilde{\theta}_{m}(t))\\
			\frac{d\tilde{\omega}_{m}(t)}{dt}=\frac{T^{*'}_{m}(t)}{J_{eq}}+K_{\omega}(\theta_{m}(t)-\tilde{\theta}_{m}(t))+K_{\omega I}\int (\theta_{m}(t)-\tilde{\theta}_{m}(t))dt
			
			\end{matrix}\right.
			\label{eq:2.1.2.x.2}
	\end{equation}
	Aplicando la transformada de Laplace a la ecuación anterior se obtiene la funciones de transferencia de la salida $\tilde{\theta}_{m}$ respecto a las entradas $\theta_{m}$ y $\frac{T'_{m}}{J_{eq}}$. A partir de esta obtenemos el polinomio característico (ec.\ref{eq:2.1.2.x.3}) con el cual podemos definir las constantes del observador para el polo deseado.

		\begin{equation}
		P_{obs}=s^{3}+K_{\theta}s^{2}+K_{\omega}s+K_{\omega I}
			\label{eq:2.1.2.x.3}
	\end{equation}

	Así mediante la ec.\ref{eq:2.1.2.x.3} y el polinomio deseado obtenemos los parámetros del observador:\\
	$K_{\theta}=9600 \frac{1}{s}$\\
	$K_{\omega}=307.2 \times 10^{5} \ \frac{1}{s^{2}}$\\
	$K_{\omega I}=3.2768 \times  10^{10} \ \frac{1}{s^{3}}$\\

	De esta manera el diagrama de bloques del observador es el mostrado en la figura \ref{fig:observadornuevo}. En la figura \ref{fig:obs} se puede observar el rechazo a una perturbación de carga para una consigna de posición igual a cero.\\
	\begin{figure}[h!]
		\centering
		\includegraphics[width=0.7\textwidth]{observadornuevo.png}
		\caption{\label{fig:observadornuevo}Observador con acción integral}
		\end{figure}
	
	\begin{figure}[h!]
		\centering
		\includegraphics[width=0.7\textwidth]{obs.png}
		\caption{\label{fig:obs}Rechazo a perturbaciones de carga.}
		\end{figure}

\item \textbf{Comportamiento térmico}\\
Se verificó la temperatura del bobinado para una operación continua repetitiva del ciclo especificado anteriormente (figura \ref{fig:rep}) y se observó que la temperatura después de varios ciclos llego a su equilibrio térmico dentro del límite establecido, por lo que el motor puede operar sin problemas para un ciclo repetitivo de la consigna propuesta. Por último en la figura \ref{fig:temp} se muestra la temperatura para la misma operación con y sin debilitamiento de campo, y se puede observar que el crecimiento de la temperatura
 sin debilitamiento de campo es ínfimo. Hay que aclarar que el motor no podría llevar a cabo esta consigna de movimiento sin debilitamiento de campo, ya que se supera el límite de tensión,
  esto se ha realizado únicamente para poder comparar los distintos comportamientos.
  \begin{figure}[h!]
	\centering
	\includegraphics[width=0.7\textwidth]{rep.png}
	\caption{\label{fig:rep}Consigna de movimiento repetitiva}
	\end{figure}
	\begin{figure}[h!]
		\centering
		\includegraphics[width=0.7\textwidth]{temp.png}
		\caption{\label{fig:temp}Temperatura del sistema}
		\end{figure}

\item \textbf{Respuesta no ideal (ancho de banda limitado) de los sensores y acondicionadores de señal}\\
Se reemplaza el modelo ideal $G(s)\equiv 1$ para los sensores asumidos hasta aquí, por modelos aproximados equivalentes con características de filtro Pasa Bajos. En la figura \ref{fig:modelocompleto} se presenta el modelo completo del sistema con los sensores no ideales.\\

 \begin{figure}[h!]
	\centering
	\includegraphics[width=\textwidth]{modelocompleto.png}
	\caption{\label{fig:modelocompleto} Modelo completo con sensores no ideales}
	\end{figure}
	
Para medir las corrientes de fase $i_{abcs}(t)$ y la posición angular $\theta_{m}(t)$ se plantea un modelo LP en SS de segundo orden con $\xi=1$. 
Para la implementación de estos sensores se los representó mediante la forma canónica observable en el espacio de estado, así mediante la función de transferencia (ec. \ref{eq:2.1.2.ww.1}) se obtuvo la ecuación \ref{eq:2.1.2.ww.2}.
		\begin{equation}
		G_{sensores}(s)=\frac{\omega_{o}^{2}}{s^{2}+ 2\cdot\xi\cdot\omega_{o}\cdot s + \omega_{0}^{2}}
			\label{eq:2.1.2.ww.1}
	\end{equation}
			\begin{equation}
\begin{cases}
\dot{X}(t)=\begin{bmatrix}
0 & 1\\ 
-\omega_{0}^{2} & -2\cdot\xi\cdot\omega_{0}
\end{bmatrix}
\cdot X(t)  \ + \
\begin{bmatrix}
0\\ 
1
\end{bmatrix} \cdot
u(t)
\\ 
Y(t)=[\omega_{0}^{2} \ \ 0]\cdot X(t)
\end{cases}
			\label{eq:2.1.2.ww.2}
	\end{equation}\\
Para sensar la temperatura $T°_{s}(t)$ se propone un modelo LP en SS de primer orden con $\tau=20s$. La función de transferencia de este sensor queda:
\begin{equation}
	G_{sensor\ temp.}(s)=\frac{ \frac{1}{\tau } }{ s + \frac{1}{\tau } }
\end{equation}
\begin{equation}
	\begin{cases}
	\dot{X}(t)=\begin{bmatrix}
	-\frac{1}{\tau }
	\end{bmatrix}
	\cdot X(t)  \ + \
	\begin{bmatrix}
	1
	\end{bmatrix} \cdot
	u(t)
	\\ 
	Y(t)=[\frac{1}{\tau}]\cdot X(t)
	\end{cases}
		\end{equation}
En las figuras \ref{fig:theta_consignas} y \ref{fig:omega_sensores} se puede ver la degradación de desempeño del sistema cuando se consideran los sensores no ideal, se puede observar que a medida que se disminuye el ancho de banda de estos
 la respuesta del sistema puede llegar hasta divergir con respecto a la deseada. Por ende se puede concluir que es algo que hay que tener muy presente en el diseño de sistemas de control, por que como se 
 aprecia en las imagen aparecen errores en los transitorios y estacionarios.
 \begin{figure}[h!]
	\centering
	\includegraphics[width=0.7\textwidth]{theta_consignas.png}
	\caption{\label{fig:theta_consignas}Posición del sistema con sensores no ideales}
	\end{figure}
 \begin{figure}[h!]
	\centering
	\includegraphics[width=0.7\textwidth]{omega_sensores.png}
	\caption{\label{fig:omega_sensores}Velocidad del sistema con sensores no ideales}
	\end{figure}

Por último, en la figura \ref{fig:corrientesensores} se muestra el efecto sobre las tensiones y corrientes de fase $abcs$ para sensores de corrientes con $\omega_{0}=11000 \frac{rad}{s}$ y de posición con $\omega_{0}=9000 \frac{rad}{s}$. Como vemos, en este caso la tensión es una variable a tener muy en cuenta, ya que aumenta pudiendo provocar que si no la tenemos en cuenta operemos fuera de los límites establecidos para esta. En este caso la tensión pico subió a $19.27 V$ por lo que seguimos dentro de nuestro límites, pero si tenemos sensores con un bando de ancho más limitado, se deberá revaluar la consigna propuesta ya que muy posiblemente se supere los límites de tensión.
 \begin{figure}[h!]
	\centering
	\includegraphics[width=0.7\textwidth]{corrientesensores.png}
	\caption{\label{fig:corrientesensores}Tensiones y corrientes de fase $abcs$ para sensores no ideales}
	\end{figure}
\end{itemize}

\newpage
\section{Conclusiones}
Logramos diseñar, modelar y simular todas las etapas de un controlador de una máquina de CA (a lazo cerrado), tanto como a lazo abierto, de forma exitosa.
A pesar de todas las simplificaciones hechas, el estudio de la máquina fue bastante amplio e integrador de todos los conocimientos abordados por la cátedra, sirviendo como referencia de cómo aplicar estos conocimientos en la vida profesional y en sistemas no tan idealizados.
Pudimos notar que a pesar de la dificultad que presentan las máquinas de CA, con las simplificaciones y estrategias planteadas, el estudio es equivalente al de una máquina de CC.
Y también que si bien los polos del sistema son todos estables, por estar en el semiplano negativo de la variable s (\textbf{Laplace}), hay una fuerte dependencia con algunos parámetros que hemos considerado constantes.
\par
Por esto es que sería bueno, a futuro, implementar una serie de mejoras que se proponen a continuación.
La más importante que hemos notado es:
\begin{itemize}
	\item Implementar una estrategia de control que contemple la posición (e inercia) del \textbf{resto de las articulaciones} del brazo, ya que la estabilidad de varios polos a lazo cerrado del sistema dependen de este factor.
\end{itemize}

Entonces como conclusión, en base al desarrollo y análisis sobre los polos, las matrices del sistema y las respuestas a lazo cerrado del mismo.
Podemos decir que, el sistema es \textbf{controlable}, \textbf{eficiente}, \textbf{robusto} y con buen \textbf{rechazo} a las perturbaciones externas dentro de los rangos establecidos.
\par
A pesar de que falta implementar varias posibles mejoras, que no se llevaron a cabo con el fin de no complejizar más el estudio del sistema.
Y de las simplificaciones realizadas, como considerar ideales algunas partes del sistema completo.
El estudio realizado fue de gran utilidad para poder entender de manera conceptual el problema y adquirir herramientas para ver cómo llevar a la práctica los conocimientos que aborda la cátedra.

\section{Referencias}

[1] Apuntes de cátedra. Automática y Maquinas Eléctricas. Profesor Ing. Gabriel Julián.

[2] Ingeniería de Control Moderna, 5ta edición, Katsuhiko Ogata, 2010.

[3] Analysis of Electric Machinery and Drive Systems, 3° Ed. Krause, P. et al.

[4] Guía del Proyecto Global Integrador. Automática y Maquinas Eléctricas. Profesor Ing. Gabriel Julián

\end{document}